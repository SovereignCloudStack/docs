<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">One post tagged with &quot;security&quot; | One platform — standardized, built and operated by many.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" name="twitter:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" property="og:url" content="https://docs.scs.community/blog/tags/security"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="One post tagged with &quot;security&quot; | One platform — standardized, built and operated by many."><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scs.community/blog/tags/security"><link data-rh="true" rel="alternate" href="https://docs.scs.community/blog/tags/security" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scs.community/blog/tags/security" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SCS Community Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SCS Community Blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="SCS Community Blog JSON Feed">









<link rel="preconnect" href="https://matomo.scs.community/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://matomo.scs.community/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","2"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.7136250c.css">
<script src="/assets/js/runtime~main.07d47f80.js" defer="defer"></script>
<script src="/assets/js/main.23799193.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/standards">Standards</a><a class="navbar__item navbar__link" href="/docs">For Operators</a><a class="navbar__item navbar__link" href="/contributor-docs">For Contributors</a><a class="navbar__item navbar__link" href="/user-docs">For Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/openstack_oauth2_privescalation_cve_2026_22797">CVE-2026-22797 OpenStack privilege escalation with oauth2 tokens</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/introducing_new_blog">Introducing A New Blog Site On Our Docs Page</a></li></ul></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>One post tagged with &quot;security&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/openstack_oauth2_privescalation_cve_2026_22797">CVE-2026-22797 OpenStack privilege escalation with oauth2 tokens</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2026-01-23T00:00:00.000Z">January 23, 2026</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/garloff" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/garloff.png" alt="Kurt Garloff"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/garloff" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Kurt Garloff</span></a></div><small class="authorTitle_nd0D" title="CEO @ S7n Cloud Services, former CTO @ SCS">CEO @ S7n Cloud Services, former CTO @ SCS</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prefix">Prefix<a href="#prefix" class="hash-link" aria-label="Direct link to Prefix" title="Direct link to Prefix" translate="no">​</a></h2>
<p>This advisory was drafted a few days ago, before the issue was public.
As the issue turned out to only affect very specific configurations (which are
not used in any standard SCS setting), we did not publish it with the urgency
that we normally apply to protect our partners in time for a vulnerability becoming
public.</p>
<p>Instead, we have taken the time to sort out the publication place in the the new Docs
blog space, as described by the previous blog post.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-vulnerability">The vulnerability<a href="#the-vulnerability" class="hash-link" aria-label="Direct link to The vulnerability" title="Direct link to The vulnerability" translate="no">​</a></h2>
<p>Keystone is the central Identity and Access Management component in OpenStack.
Whenever you talk to an OpenStack service, you authenticate to keystone via
one of the supported methods. In return, keystone will issue a token that
entitles you to have certain privileges when talking to the individual services.</p>
<p>One of the supported ways to authenticate is to use oauth2 tokens.
When keystonemiddleware investigates these
tokens it adds headers that indicate privileges associated with the account.</p>
<p>Unfortunately, keystonemiddleware does not clear headers when receiving
oauth2 tokens, so an authenticated user can send oauth2 tokens with
headers that actually indicate admin privileges and can trick services
into assuming elevated privileges.
The issue was introduced with keystonemiddleware 10.5.0 when support for
<code>external_oauth2_tokens</code> was added.</p>
<p>The vulnerability has been assigned <a href="https://nvd.nist.gov/vuln/detail/CVE-2026-22797" target="_blank" rel="noopener noreferrer" class="">CVE-2026-22797</a>.</p>
<p>The issue was reported by Grzegorz Grasza of RedHat.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="impact-on-openstack-deployments">Impact on OpenStack deployments<a href="#impact-on-openstack-deployments" class="hash-link" aria-label="Direct link to Impact on OpenStack deployments" title="Direct link to Impact on OpenStack deployments" translate="no">​</a></h2>
<p>When keystone is configured to accept oauth2 tokens for authentication, anyone
able to produce and send any valid tokens may inject headers to impersonate other
users or assume additional roles up to and including admin privileges. Admin
privileges allow unrestricted access via the API and are only meant to be used
by the cloud operators.</p>
<p><em>To abuse this vulnerability, the attacker must be an authenticated
user of the platform. In addition, the platform must be configured to
accept oauth2 tokens, which is not a supported configuration in yaook
nor a simple change versus the default configuration is OSISM.</em></p>
<p>To make services accept oauth2 tokens, their config would need
to be changed via <code>paste.ini</code></p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[pipeline:main]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline = ext_oauth2_token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[filter:ext_oauth2_token]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">paste.filter_factory = keystonemiddleware.external_oauth2_token:filter_factory</span><br></span></code></pre></div></div>
<p>in order to be affected. This is not the case in any default configurations and
also not when using the OIDC federation with keycloak that is documented for SCS.</p>
<p>Providers are advised to investigate whether they have done changes to enable oauth2
tokens via keystonemiddleware as depicted above and assume that they are affected
in that case.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="embargo">Embargo<a href="#embargo" class="hash-link" aria-label="Direct link to Embargo" title="Direct link to Embargo" translate="no">​</a></h2>
<p>The issue has been reported to the OpenStack Vulnerability Management Team in
private. The reporters and upstream developers have worked together to address
the issue with fixes and an embargo date has been set to Thursday, 2026-01-15,
15:00 UTC (16:00 CET). At this point in
time, the patches get merged and the OpenStack Security Advisory
(<a href="https://security.openstack.org/ossa/OSSA-2026-001.html" target="_blank" rel="noopener noreferrer" class="">OSSA-2026-001</a>)
is published. The issue is tracked in OpenStack issue
<a href="https://bugs.launchpad.net/keystonemiddleware/+bug/2129018" target="_blank" rel="noopener noreferrer" class="">#2219018</a>, which should become
publically accessible after the lift of the embargo and the publication
of this advisory.</p>
<p>Under the used responsible disclosure approach, the information was shared with
a select group of trustable users of OpenStack, so they can prepare updates and
protect their infrastructure at the time this issue becomes public.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="mitigation-and-fixes">Mitigation and Fixes<a href="#mitigation-and-fixes" class="hash-link" aria-label="Direct link to Mitigation and Fixes" title="Direct link to Mitigation and Fixes" translate="no">​</a></h2>
<p>The fix is straightforward and consists of clearing headers and explicitly
unsetting the critical headers. For affected setups, it is recommended to update
the keystone services immediately.</p>
<p>For clouds that can not update keystone directly, the dangerous headers could
be filtered out by a reverse proxy or similar network infrastructure in front
of the openstack API services or the oauth2 tokens could be temporarily disabled
by reverting back to the standard</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[filter:authtoken]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">paste.filter_factory = keystonemiddleware.auth_token:filter_factory</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="links-to-specific-information-from-related-openstack-distributions">Links to specific information from related OpenStack distributions<a href="#links-to-specific-information-from-related-openstack-distributions" class="hash-link" aria-label="Direct link to Links to specific information from related OpenStack distributions" title="Direct link to Links to specific information from related OpenStack distributions" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://alasca.cloud/" target="_blank" rel="noopener noreferrer" class="">ALASCA</a> has issued an
<a href="https://lists.alasca.cloud/hyperkitty/list/yaook@lists.alasca.cloud/thread/Q2GZ7PNXHJ7YHRDALKXTHZMTHS7PM5NE/" target="_blank" rel="noopener noreferrer" class="">advisory for yaook</a>
basically stating that it&#x27;s not really possible to use yaook in a way that it would be affected.</li>
<li class=""><a href="https://osism.tech/" target="_blank" rel="noopener noreferrer" class="">OSISM</a> has published an
<a href="https://osism.tech/docs/appendix/security/ossa-2026-001/" target="_blank" rel="noopener noreferrer" class="">advisary for OSISM</a>
with more details how to get a fixed keystone container deployed in case you
have manually enabled such oauth2 tokens.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="thanks">Thanks<a href="#thanks" class="hash-link" aria-label="Direct link to Thanks" title="Direct link to Thanks" translate="no">​</a></h2>
<p>The authors would like to thank Grzegorz Grasza, Thomas Goirand (zigo),
Jay Faulkner, David Wilde, Artem Goncharov and Jeremy Stanley for their
work on this issue.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="sovereign-cloud-stack-security-contact">Sovereign Cloud Stack Security Contact<a href="#sovereign-cloud-stack-security-contact" class="hash-link" aria-label="Direct link to Sovereign Cloud Stack Security Contact" title="Direct link to Sovereign Cloud Stack Security Contact" translate="no">​</a></h2>
<p>SCS security contact is <a href="mailto:security@scs.community" target="_blank" rel="noopener noreferrer" class="">security@scs.community</a>, as published on
<a href="https://scs.community/.well-known/security.txt" target="_blank" rel="noopener noreferrer" class="">https://scs.community/.well-known/security.txt</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="version-history">Version history<a href="#version-history" class="hash-link" aria-label="Direct link to Version history" title="Direct link to Version history" translate="no">​</a></h2>
<ul>
<li class="">Initial Draft, v0.1, 2026-01-13, 22:30 CET.</li>
<li class="">Release, v1.0, 2026-01-20, 08:30 CET.</li>
<li class="">Release to SCS docs blog, v1.1, 2026-01-23, 10:30 CET.</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/security">security</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/openstack">openstack</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/cve">cve</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Contribute</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@sovereigncloudstack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</div></div></div></footer></div>
</body>
</html>