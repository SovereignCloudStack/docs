"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[78353],{31642:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"operating-scs/components/scs-health-monitor/overview","title":"SCS Health Monitor","description":"Welcome to the SCS Health Monitor project! This repository is dedicated to setting up scenarios for functionality and load testing on a deployed OpenStack environment. We utilize the Gherkin language to write testing scenarios, and Python\'s Behave library to execute these tests.","source":"@site/docs/04-operating-scs/components/scs-health-monitor/overview.md","sourceDirName":"04-operating-scs/components/scs-health-monitor","slug":"/operating-scs/components/scs-health-monitor/overview","permalink":"/docs/operating-scs/components/scs-health-monitor/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/SovereignCloudStack/docs/tree/main/docs/04-operating-scs/components/scs-health-monitor/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"SCS Health Monitor","permalink":"/docs/category/scs-health-monitor"},"next":{"title":"Kubernetes BDD Testing Framework Documentation","permalink":"/docs/operating-scs/components/scs-health-monitor/Workflow"}}');var i=s(74848),o=s(28453);const r={},a="SCS Health Monitor",l={},c=[{value:"Description",id:"description",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Using the test framework",id:"using-the-test-framework",level:2},{value:"Execute a specific test",id:"execute-a-specific-test",level:3},{value:"Execute a series of tests",id:"execute-a-series-of-tests",level:3},{value:"Publish results to Prometheus",id:"publish-results-to-prometheus",level:2},{value:"Setting up Prometheus and Prometheus Push Gateway locally",id:"setting-up-prometheus-and-prometheus-push-gateway-locally",level:3},{value:"Exporting metrics to Prometheus Push Gateway",id:"exporting-metrics-to-prometheus-push-gateway",level:3},{value:"Use a docker image",id:"use-a-docker-image",level:2},{value:"Collaborators",id:"collaborators",level:2},{value:"Useful links and references",id:"useful-links-and-references",level:2}];function h(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"scs-health-monitor",children:"SCS Health Monitor"})}),"\n",(0,i.jsx)(t.p,{children:"Welcome to the SCS Health Monitor project! This repository is dedicated to setting up scenarios for functionality and load testing on a deployed OpenStack environment. We utilize the Gherkin language to write testing scenarios, and Python's Behave library to execute these tests."}),"\n",(0,i.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,i.jsx)(t.p,{children:"The SCS Health Monitor project aims to ensure the robustness and reliability of OpenStack environments by simulating various scenarios and assessing their performance under different loads. By employing the Gherkin language and the Behave library, we can define clear, human-readable test cases that cover a wide range of functionalities, from basic system checks to complex stress tests."}),"\n",(0,i.jsxs)(t.p,{children:["See ",(0,i.jsx)(t.a,{href:"Rationale.md",children:"Rationale.md"})," for more background on the chosen technologies."]}),"\n",(0,i.jsx)(t.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,i.jsx)(t.p,{children:"To get started with the SCS Health Monitor project, follow these steps:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Clone ",(0,i.jsx)(t.a,{href:"https://github.com/SovereignCloudStack/scs-health-monitor",children:"health-monitor repository"})," to your local machine."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"git clone git@github.com:SovereignCloudStack/scs-health-monitor.git\ncd scs-health-monitor\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Install the required dependencies"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["listed in the ",(0,i.jsx)(t.code,{children:"[Dockerfile](https://github.com/SovereignCloudStack/scs-health-monitor/blob/main/Dockerfile)"})," file\n(see: ",(0,i.jsx)(t.code,{children:"apt-get ..."}),")"]}),"\n",(0,i.jsxs)(t.li,{children:["listed in the ",(0,i.jsx)(t.code,{children:"[requirements.txt](https://github.com/SovereignCloudStack/scs-health-monitor/blob/main/requirements.txt)"})," file by executing the following command:","\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"./scs-health-monitor deps\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Review the existing Gherkin scenarios in the ",(0,i.jsx)(t.code,{children:"[cloud_level_testing/features](https://github.com/SovereignCloudStack/scs-health-monitor/tree/main/cloud_level_testing/features)"})," and ",(0,i.jsx)(t.code,{children:"[container_level_testing/features](https://github.com/SovereignCloudStack/scs-health-monitor/tree/main/container_level_testing/features)"})," directories to understand the testing coverage."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:'Create an openstack project with a user with "manager" privileges and suitable quotas:'}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"cores: 50"}),"\n",(0,i.jsx)(t.li,{children:"instances: 30"}),"\n",(0,i.jsx)(t.li,{children:"ram: 128000"}),"\n",(0,i.jsx)(t.li,{children:"volumes: 20"}),"\n",(0,i.jsx)(t.li,{children:"gigabytes: 200"}),"\n",(0,i.jsx)(t.li,{children:"security_groups: 50"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["You can use the ",(0,i.jsx)(t.a,{href:"https://github.com/SovereignCloudStack/openstack-workload-generator",children:"openstack workload generator"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"${OPENSTACK_WORKLOAD_GENERATOR_INSTALLATION_DIR}/openstack_workload_generator \\\n --create_domains scs-health-monitor \\\n --create_projects test-project \\\n --create_machines none \\\n --clouds_yaml $PWD/clouds.yaml \\\n --config ${OPENSTACK_WORKLOAD_GENERATOR_INSTALLATION_DIR}/profiles/health-mon.yaml\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Create a ",(0,i.jsx)(t.code,{children:"clouds.yaml"})," (",(0,i.jsx)(t.a,{href:"/assets/config-examples/clouds.yaml",children:"example"}),") file in the root of the repository-clone to configure API access to OpenStack."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Create a ",(0,i.jsx)(t.code,{children:"env.yaml"})," (",(0,i.jsx)(t.a,{href:"/assets/config-examples/env.yaml",children:"example"}),") file containing configuration needed for performing the tests.\n(Configure at least the ",(0,i.jsx)(t.code,{children:"CLOUD_NAME"})," to specify which project should be used)"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Execute the tests using Behave library to validate the functionality and performance of your OpenStack environment.\n(see ",(0,i.jsx)(t.a,{href:"#using-the-test-framework",children:"next section"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"using-the-test-framework",children:"Using the test framework"}),"\n",(0,i.jsx)(t.h3,{id:"execute-a-specific-test",children:"Execute a specific test"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"./scs-health-monitor behave cloud_level_testing/features/openstack_create_network.feature\n"})}),"\n",(0,i.jsx)(t.p,{children:"Here are some basic commands to run the tests:"}),"\n",(0,i.jsx)(t.h3,{id:"execute-a-series-of-tests",children:"Execute a series of tests"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Run all scenarios for IaaS"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"./scs-health-monitor behave cloud_level_testing/features/\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Run all scenarios for KaaS"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"./scs-health-monitor behave container_level_testing/features/\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:'Run all scenarios for IaaS with the "network" and the "cleanup" tag'}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"./scs-health-monitor behave --tags=network  cloud_level_testing/features/\n./scs-health-monitor behave --tags=cleanup  cloud_level_testing/features/\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Run all of the IaaS scenarios, but parallel only the features"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"./scs-health-monitor behavex --parallel-scheme cloud_level_testing/features/\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["There is a possibility to run it on the ",(0,i.jsx)(t.a,{href:"https://github.com/hrcorval/behavex",children:"behavex"})," framework as well. To get more information, ",(0,i.jsx)(t.a,{href:"https://pypi.org/project/behavex/",children:"here"})," is a link to the documentation."]}),"\n",(0,i.jsx)(t.h2,{id:"publish-results-to-prometheus",children:"Publish results to Prometheus"}),"\n",(0,i.jsxs)(t.p,{children:["The scs-health-monitor is capable to publish the results to a prometheus instance.\nDetails of the available measurements are available in the ",(0,i.jsx)(t.a,{href:"docs/Metric_List.md",children:"METRIC OVERVIEW"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"setting-up-prometheus-and-prometheus-push-gateway-locally",children:"Setting up Prometheus and Prometheus Push Gateway locally"}),"\n",(0,i.jsx)(t.p,{children:"For the purposes of gathering information from the test cases being performed against OpenStack, Prometheus metrics are being gathered during excecution of the test, then later these metrics are pushed to a Prometheus Push Gateway."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"./ObservabilityStack/SetupObservabilityStack.md",children:"Here"})," you can find a useful quickstart guide on setting up Promethus Stack and Prometheus push gateway locally."]}),"\n",(0,i.jsx)(t.h3,{id:"exporting-metrics-to-prometheus-push-gateway",children:"Exporting metrics to Prometheus Push Gateway"}),"\n",(0,i.jsxs)(t.p,{children:["To be able to push the metrics gathered during test executions, you must first configure the prometheus push gateway endpoint. You achieve this by adding these lines to a ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.a,{href:"/assets/config-examples/env.yaml",children:"env.yaml"})}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'# Required\n# If not present the metrics won\'t\n# be pushed by the test scenarios\nPROMETHEUS_ENDPOINT: "localhost:30001"\n\n# Optional (default: "SCS-Health-Monitor")\n# Specify the job label value that\n# gets added to the metrics\nPROMETHEUS_BATCH_NAME: "SCS-Health-Monitor"\n\n# Required\n# The name of the cloud from clouds.yaml\n# that the test scenarios will be ran on\nCLOUD_NAME: "gx"\n\n# Optional (default: true)\n# Apply start time and stop time to prometheus batch name\nAPPEND_TIMESTAMP_TO_BATCH_NAME: true\n'})}),"\n",(0,i.jsxs)(t.p,{children:["This ",(0,i.jsx)(t.code,{children:"env.yaml"})," file must be placed in the root of the repository. This is where you should be also issueing all the ",(0,i.jsx)(t.em,{children:"behave <...>"})," commands to execute the test scenarios."]}),"\n",(0,i.jsx)(t.h2,{id:"use-a-docker-image",children:"Use a docker image"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Create a docker image","\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"docker build --progress plain -t scs-health-monitor -f Dockerfile .\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Execute a docker image","\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'sudo chown 1001:1001 ./env.yaml ./clouds.yaml ./ca-certificates.crt\nDOCKER_MOUNTS="-v ./env.yaml:/installation/env.yaml -v ./clouds.yaml:/installation/clouds.yaml -v ./ca-certificates.crt:/installation/ca-certificates.crt"\n# A shell\ndocker run -ti ${DOCKER_MOUNTS?not set} --rm --entrypoint /bin/bash --name scs-health-monitor scs-health-monitor\n# Entrypoint execution\ndocker run -ti ${DOCKER_MOUNTS?not set} --rm --name scs-health-monitor scs-health-monitor behave <ARGUMENTS>\ndocker run -ti ${DOCKER_MOUNTS?not set} --rm --name scs-health-monitor scs-health-monitor behave cloud_level_testing/features/openstack_create_network.feature\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"collaborators",children:"Collaborators"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Piotr Bigos ",(0,i.jsx)(t.a,{href:"https://github.com/piobig2871",children:"@piobig2871"})]}),"\n",(0,i.jsxs)(t.li,{children:["Erik Kostelansk\xfd ",(0,i.jsx)(t.a,{href:"https://github.com/Erik-Kostelansky-dNation",children:"@Erik-Kostelansky-dNation"})]}),"\n",(0,i.jsxs)(t.li,{children:["Katharina Trentau ",(0,i.jsx)(t.a,{href:"https://github.com/fraugabel",children:"@fraugabel"})]}),"\n",(0,i.jsxs)(t.li,{children:["\u013dubom\xedr Dobrovodsk\xfd ",(0,i.jsx)(t.a,{href:"https://github.com/dobrovodskydnation",children:"@dobrovodskydnation"})]}),"\n",(0,i.jsxs)(t.li,{children:["Tom\xe1\u0161 Sm\xe4do ",(0,i.jsx)(t.a,{href:"https://github.com/tsmado",children:"@tsmado"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"useful-links-and-references",children:"Useful links and references"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://docs.openstack.org/openstacksdk/latest/user/",children:"Openstack python SDK documentation"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://docs.openstack.org/python-openstackclient/latest/",children:"Openstack CLI tool documentation"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://jenisys.github.io/behave.example/tutorials/tutorial04.html",children:"Parameterisation of tests using scenario outlines"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://behave.readthedocs.io/en/stable/tutorial.html",children:"Short but concise tutorial on how to setup behave test scenarios"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/SovereignCloudStack/openstack-health-monitor",children:"The legacy but complete implementation"})}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>a});var n=s(96540);const i={},o=n.createContext(i);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);