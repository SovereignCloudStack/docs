"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[38590],{31266:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var i=n(48189),a=n(74848),s=n(28453);const o={slug:"openstack_oauth2_privescalation_cve_2026_22797",title:"CVE-2026-22797 OpenStack privilege escalation with oauth2 tokens",authors:["garloff"],tags:["security","openstack","cve"]},r=void 0,l={authorsImageUrls:[void 0]},c=[{value:"Prefix",id:"prefix",level:2},{value:"The vulnerability",id:"the-vulnerability",level:2},{value:"Impact on OpenStack deployments",id:"impact-on-openstack-deployments",level:2},{value:"Embargo",id:"embargo",level:2},{value:"Mitigation and Fixes",id:"mitigation-and-fixes",level:2},{value:"Links to specific information from related OpenStack distributions",id:"links-to-specific-information-from-related-openstack-distributions",level:3},{value:"Thanks",id:"thanks",level:2},{value:"Sovereign Cloud Stack Security Contact",id:"sovereign-cloud-stack-security-contact",level:2},{value:"Version history",id:"version-history",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"prefix",children:"Prefix"}),"\n",(0,a.jsx)(t.p,{children:"This advisory was drafted a few days ago, before the issue was public.\nAs the issue turned out to only affect very specific configurations (which are\nnot used in any standard SCS setting), we did not publish it with the urgency\nthat we normally apply to protect our partners in time for a vulnerability becoming\npublic."}),"\n",(0,a.jsx)(t.p,{children:"Instead, we have taken the time to sort out the publication place in the the new Docs\nblog space, as described by the previous blog post."}),"\n",(0,a.jsx)(t.h2,{id:"the-vulnerability",children:"The vulnerability"}),"\n",(0,a.jsx)(t.p,{children:"Keystone is the central Identity and Access Management component in OpenStack.\nWhenever you talk to an OpenStack service, you authenticate to keystone via\none of the supported methods. In return, keystone will issue a token that\nentitles you to have certain privileges when talking to the individual services."}),"\n",(0,a.jsx)(t.p,{children:"One of the supported ways to authenticate is to use oauth2 tokens.\nWhen keystonemiddleware investigates these\ntokens it adds headers that indicate privileges associated with the account."}),"\n",(0,a.jsxs)(t.p,{children:["Unfortunately, keystonemiddleware does not clear headers when receiving\noauth2 tokens, so an authenticated user can send oauth2 tokens with\nheaders that actually indicate admin privileges and can trick services\ninto assuming elevated privileges.\nThe issue was introduced with keystonemiddleware 10.5.0 when support for\n",(0,a.jsx)(t.code,{children:"external_oauth2_tokens"})," was added."]}),"\n",(0,a.jsxs)(t.p,{children:["The vulnerability has been assigned ",(0,a.jsx)(t.a,{href:"https://nvd.nist.gov/vuln/detail/CVE-2026-22797",children:"CVE-2026-22797"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"The issue was reported by Grzegorz Grasza of RedHat."}),"\n",(0,a.jsx)(t.h2,{id:"impact-on-openstack-deployments",children:"Impact on OpenStack deployments"}),"\n",(0,a.jsx)(t.p,{children:"When keystone is configured to accept oauth2 tokens for authentication, anyone\nable to produce and send any valid tokens may inject headers to impersonate other\nusers or assume additional roles up to and including admin privileges. Admin\nprivileges allow unrestricted access via the API and are only meant to be used\nby the cloud operators."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.em,{children:"To abuse this vulnerability, the attacker must be an authenticated\nuser of the platform. In addition, the platform must be configured to\naccept oauth2 tokens, which is not a supported configuration in yaook\nnor a simple change versus the default configuration is OSISM."})}),"\n",(0,a.jsxs)(t.p,{children:["To make services accept oauth2 tokens, their config would need\nto be changed via ",(0,a.jsx)(t.code,{children:"paste.ini"})]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",children:"[pipeline:main]\npipeline = ext_oauth2_token\n\n[filter:ext_oauth2_token]\npaste.filter_factory = keystonemiddleware.external_oauth2_token:filter_factory\n"})}),"\n",(0,a.jsx)(t.p,{children:"in order to be affected. This is not the case in any default configurations and\nalso not when using the OIDC federation with keycloak that is documented for SCS."}),"\n",(0,a.jsx)(t.p,{children:"Providers are advised to investigate whether they have done changes to enable oauth2\ntokens via keystonemiddleware as depicted above and assume that they are affected\nin that case."}),"\n",(0,a.jsx)(t.h2,{id:"embargo",children:"Embargo"}),"\n",(0,a.jsxs)(t.p,{children:["The issue has been reported to the OpenStack Vulnerability Management Team in\nprivate. The reporters and upstream developers have worked together to address\nthe issue with fixes and an embargo date has been set to Thursday, 2026-01-15,\n15:00 UTC (16:00 CET). At this point in\ntime, the patches get merged and the OpenStack Security Advisory\n(",(0,a.jsx)(t.a,{href:"https://security.openstack.org/ossa/OSSA-2026-001.html",children:"OSSA-2026-001"}),")\nis published. The issue is tracked in OpenStack issue\n",(0,a.jsx)(t.a,{href:"https://bugs.launchpad.net/keystonemiddleware/+bug/2129018",children:"#2219018"}),", which should become\npublically accessible after the lift of the embargo and the publication\nof this advisory."]}),"\n",(0,a.jsx)(t.p,{children:"Under the used responsible disclosure approach, the information was shared with\na select group of trustable users of OpenStack, so they can prepare updates and\nprotect their infrastructure at the time this issue becomes public."}),"\n",(0,a.jsx)(t.h2,{id:"mitigation-and-fixes",children:"Mitigation and Fixes"}),"\n",(0,a.jsx)(t.p,{children:"The fix is straightforward and consists of clearing headers and explicitly\nunsetting the critical headers. For affected setups, it is recommended to update\nthe keystone services immediately."}),"\n",(0,a.jsx)(t.p,{children:"For clouds that can not update keystone directly, the dangerous headers could\nbe filtered out by a reverse proxy or similar network infrastructure in front\nof the openstack API services or the oauth2 tokens could be temporarily disabled\nby reverting back to the standard"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",children:"[filter:authtoken]\npaste.filter_factory = keystonemiddleware.auth_token:filter_factory\n"})}),"\n",(0,a.jsx)(t.h3,{id:"links-to-specific-information-from-related-openstack-distributions",children:"Links to specific information from related OpenStack distributions"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://alasca.cloud/",children:"ALASCA"})," has issued an\n",(0,a.jsx)(t.a,{href:"https://lists.alasca.cloud/hyperkitty/list/yaook@lists.alasca.cloud/thread/Q2GZ7PNXHJ7YHRDALKXTHZMTHS7PM5NE/",children:"advisory for yaook"}),"\nbasically stating that it's not really possible to use yaook in a way that it would be affected."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://osism.tech/",children:"OSISM"})," has published an\n",(0,a.jsx)(t.a,{href:"https://osism.tech/docs/appendix/security/ossa-2026-001/",children:"advisary for OSISM"}),"\nwith more details how to get a fixed keystone container deployed in case you\nhave manually enabled such oauth2 tokens."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"thanks",children:"Thanks"}),"\n",(0,a.jsx)(t.p,{children:"The authors would like to thank Grzegorz Grasza, Thomas Goirand (zigo),\nJay Faulkner, David Wilde, Artem Goncharov and Jeremy Stanley for their\nwork on this issue."}),"\n",(0,a.jsx)(t.h2,{id:"sovereign-cloud-stack-security-contact",children:"Sovereign Cloud Stack Security Contact"}),"\n",(0,a.jsxs)(t.p,{children:["SCS security contact is ",(0,a.jsx)(t.a,{href:"mailto:security@scs.community",children:"security@scs.community"}),", as published on\n",(0,a.jsx)(t.a,{href:"https://scs.community/.well-known/security.txt",children:"https://scs.community/.well-known/security.txt"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"version-history",children:"Version history"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Initial Draft, v0.1, 2026-01-13, 22:30 CET."}),"\n",(0,a.jsx)(t.li,{children:"Release, v1.0, 2026-01-20, 08:30 CET."}),"\n",(0,a.jsx)(t.li,{children:"Release to SCS docs blog, v1.1, 2026-01-23, 10:30 CET."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var i=n(96540);const a={},s=i.createContext(a);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:t},e.children)}},48189:e=>{e.exports=JSON.parse('{"permalink":"/blog/openstack_oauth2_privescalation_cve_2026_22797","editUrl":"https://github.com/SovereignCloudStack/docs/edit/main/blog/2026-01-23-cve-2026-22797.md","source":"@site/blog/2026-01-23-cve-2026-22797.md","title":"CVE-2026-22797 OpenStack privilege escalation with oauth2 tokens","description":"Prefix","date":"2026-01-23T00:00:00.000Z","tags":[{"inline":true,"label":"security","permalink":"/blog/tags/security"},{"inline":true,"label":"openstack","permalink":"/blog/tags/openstack"},{"inline":true,"label":"cve","permalink":"/blog/tags/cve"}],"readingTime":3.95,"hasTruncateMarker":false,"authors":[{"name":"Kurt Garloff","title":"CEO @ S7n Cloud Services, former CTO @ SCS","url":"https://github.com/garloff","imageURL":"https://github.com/garloff.png","key":"garloff","page":null}],"frontMatter":{"slug":"openstack_oauth2_privescalation_cve_2026_22797","title":"CVE-2026-22797 OpenStack privilege escalation with oauth2 tokens","authors":["garloff"],"tags":["security","openstack","cve"]},"unlisted":false,"nextItem":{"title":"Introducing A New Blog Site On Our Docs Page","permalink":"/blog/introducing_new_blog"}}')}}]);