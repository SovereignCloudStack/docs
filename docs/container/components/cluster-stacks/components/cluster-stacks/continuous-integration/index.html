<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-container/components/cluster-stacks/components/cluster-stacks/continuous-integration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Continuous integration | One platform — standardized, built and operated by many.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" name="twitter:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" property="og:url" content="https://docs.scs.community/docs/container/components/cluster-stacks/components/cluster-stacks/continuous-integration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Continuous integration | One platform — standardized, built and operated by many."><meta data-rh="true" name="description" content="Project cluster-stacks use the SCS Zuul CI platform to"><meta data-rh="true" property="og:description" content="Project cluster-stacks use the SCS Zuul CI platform to"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/cluster-stacks/continuous-integration"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/cluster-stacks/continuous-integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/cluster-stacks/continuous-integration" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="One platform — standardized, built and operated by many. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="One platform — standardized, built and operated by many. Atom Feed">








<link rel="preconnect" href="https://matomo.scs.community/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://matomo.scs.community/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","2"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.0eddb8c7.css">
<script src="/assets/js/runtime~main.ede2d0ee.js" defer="defer"></script>
<script src="/assets/js/main.ff9c6252.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/standards">Standards</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">For Operators</a><a class="navbar__item navbar__link" href="/contributor-docs">For Contributors</a><a class="navbar__item navbar__link" href="/user-docs">For Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Continuous integration</h1></header>
<p>Project <code>cluster-stacks</code> use the <a href="https://zuul.scs.community" target="_blank" rel="noopener noreferrer">SCS Zuul</a> CI platform to
drive its continuous integration tests. The project is registered under the <a href="https://zuul.scs.community/t/SCS/projects" target="_blank" rel="noopener noreferrer">SCS tenant</a>
and therefore is able to use a set of pre-defined pipelines, jobs, and ansible roles that the
SCS Zuul instance defines and imports. If you want to explore currently available SCS pipelines,
visit the <a href="https://github.com/SovereignCloudStack/zuul-config" target="_blank" rel="noopener noreferrer">SCS zuul-config</a> project.
If you want to see the full list of jobs that are available, visit the <a href="https://zuul.scs.community/t/SCS/jobs" target="_blank" rel="noopener noreferrer">SCS Zuul UI</a>.
And if you are looking for some handy ansible role that SCS Zuul imports, visit the <a href="https://opendev.org/zuul/zuul-jobs/src/branch/master/roles" target="_blank" rel="noopener noreferrer">source</a>.</p>
<p>Refer to the SCS <a href="https://github.com/SovereignCloudStack/docs/blob/main/contributor-docs/operations/operations/zuul-ci-cd-quickstart-user-guide.md" target="_blank" rel="noopener noreferrer">Zuul users guide</a> and/or
<a href="https://zuul-ci.org/docs/" target="_blank" rel="noopener noreferrer">Zuul docs</a> for further details on how to define and use Zuul
CI/CD pipelines and jobs.</p>
<blockquote>
<p>[!NOTE]
If you are interested in the Zuul CI platform and want to deploy your own development instance of it,
then read the official <a href="https://zuul-ci.org/docs/zuul/latest/tutorials/quick-start.html" target="_blank" rel="noopener noreferrer">quick-start</a> manual
or visit <a href="https://github.com/matofederorg/zuul-config?tab=readme-ov-file#zuul-ci" target="_blank" rel="noopener noreferrer">this</a> tutorial which aims a connect
of Zuul CI platform with a GitHub organization.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>SCS Zuul automatically recognizes <code>.zuul.yaml</code> configuration file that is located in the
cluster-stacks&#x27;s root. This file informs Zuul about the project&#x27;s <a href="https://zuul-ci.org/docs/zuul/latest/config/project.html#attr-project.default-branch" target="_blank" rel="noopener noreferrer">default-branch</a> and
preferred <a href="https://zuul-ci.org/docs/zuul/latest/config/project.html#attr-project.merge-mode" target="_blank" rel="noopener noreferrer">merge-mode</a>.
It also references <a href="https://github.com/SovereignCloudStack/zuul-config" target="_blank" rel="noopener noreferrer">SCS Zuul pipelines</a> and
their jobs used by the cluster-stacks project. Then, jobs link Ansible playbooks that contain
tasks for actual CI testing.</p>
<p>See relevant CI configuration files:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── .zuul.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── playbooks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ├── dependencies.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ├── openstack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   ├──  e2e.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   ├──  templates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   │    ├── mgmt-cluster-config.yaml.j2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   │    ├── cluster.yaml.j2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   │    └── cluster-stack-template.yaml.j2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pipelines">Pipelines<a href="#pipelines" class="hash-link" aria-label="Direct link to Pipelines" title="Direct link to Pipelines">​</a></h2>
<p>This section describes an <a href="https://github.com/SovereignCloudStack/zuul-config/blob/main/zuul.d/gh_pipelines.yaml" target="_blank" rel="noopener noreferrer">SCS Zuul pipelines</a> that are used by the cluster-stacks project.</p>
<ul>
<li>
<p><code>e2e-test</code></p>
<ul>
<li>It is triggered by the <code>e2e-test</code> label in the opened PR</li>
<li>It executes <code>e2e-openstack-conformance</code> job</li>
<li>It applies the PR label <code>successful-e2e-test</code> and leaves an informative PR comment when the <code>e2e-openstack-conformance</code> job succeeded</li>
<li>It applies the PR label <code>failed-e2e-test</code> and leaves an informative PR comment when the <code>e2e-openstack-conformance</code> job failed</li>
<li>It applies the PR label <code>cancelled-e2e-test</code> and leaves an informative PR comment when the <code>e2e-openstack-conformance</code> job is canceled</li>
</ul>
</li>
<li>
<p><code>unlabel-on-update-e2e-test</code></p>
<ul>
<li>It is triggered by the PR update only when PR contains the <code>successful-e2e-test</code> label</li>
<li>It ensures that any PR update invalidates a previous successful e2e test</li>
<li>It removes <code>successful-e2e-test</code> label from the PR</li>
</ul>
</li>
<li>
<p><code>e2e-quick-test</code></p>
<ul>
<li>It is triggered by the <code>e2e-quick-test</code> label in the opened PR</li>
<li>It executes <code>e2e-openstack-quick</code> job</li>
<li>It applies the PR label <code>successful-e2e-quick-test</code> and leaves an informative PR comment when the <code>e2e-openstack-quick</code> job succeeded</li>
<li>It applies the PR label <code>failed-e2e-quick-test</code> and leaves an informative PR comment when the <code>e2e-openstack-quick</code> job failed</li>
<li>It applies the PR label <code>cancelled-e2e-quick-test</code> and leaves an informative PR comment when the <code>e2e-openstack-quick</code> job is canceled</li>
</ul>
</li>
<li>
<p><code>unlabel-on-update-e2e-quick-test</code></p>
<ul>
<li>It is triggered by the PR update only when PR contains the <code>successful-e2e-quick-test</code> label</li>
<li>It ensures that any PR update invalidates a previous successful e2e test</li>
<li>It removes <code>successful-e2e-quick-test</code> label from the PR</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jobs">Jobs<a href="#jobs" class="hash-link" aria-label="Direct link to Jobs" title="Direct link to Jobs">​</a></h2>
<p>This section describes Zuul jobs defined within the cluster-stacks project and linked in the above pipelines.</p>
<ul>
<li>
<p><code>e2e-openstack-conformance</code></p>
<ul>
<li>It runs a sonobuoy conformance test against Kubernetes cluster spawned by a specific cluster-stack</li>
<li>This job is a child job of <code>openstack-access-base</code> that ensures OpenStack credentials
availability in Zuul worker node. Parent job also defines a Zuul semaphore <code>semaphore-openstack-access</code>,
that ensures that a maximum of three <code>openstack-access-base</code> jobs (or their children) can run at a time</li>
<li>See a high level <code>e2e-openstack-conformance</code> job steps:<!-- -->
<ul>
<li>Pre-run playbook <code>dependencies.yaml</code> installs project prerequisites, e.g. clusterctl, KinD, csctl, etc.</li>
<li>Main playbook <code>e2e.yaml</code> spawns a k8s workload cluster using a specific cluster-stack in OpenStack, runs sonobuoy conformance test, SCS compliance test, and cleans created k8s workload cluster</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>e2e-openstack-quick</code></p>
<ul>
<li>It runs a sonobuoy quick test against Kubernetes cluster spawned by a specific cluster-stack</li>
<li>This job is a child job of <code>openstack-access-base</code> that ensures OpenStack credentials
availability in Zuul worker node. Parent job also defines a Zuul semaphore <code>semaphore-openstack-access</code>,
that ensures that a maximum of three <code>openstack-access-base</code> jobs (or their children) can run at a time</li>
<li>See a high level <code>e2e-openstack-quick</code> job steps:<!-- -->
<ul>
<li>Pre-run playbook <code>dependencies.yaml</code> installs project prerequisites, e.g. clusterctl, KinD, csctl, etc.</li>
<li>Main playbook <code>e2e.yaml</code> spawns a k8s workload cluster using a specific cluster-stack in OpenStack, runs sonobuoy quick test, SCS compliance test, and cleans created k8s workload cluster</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secrets">Secrets<a href="#secrets" class="hash-link" aria-label="Direct link to Secrets" title="Direct link to Secrets">​</a></h3>
<p>The parent job <code>openstack-access-base</code>, from which e2e jobs inherit, defines the secret variable <code>openstack-application-credential</code>.
This secret is stored directly in the <a href="https://github.com/SovereignCloudStack/zuul-config/blob/main/zuul.d/secrets.yaml" target="_blank" rel="noopener noreferrer">SCS/zuul-config repository</a> in an encrypted form. It contains OpenStack application credentials to access the OpenStack project dedicated to CI testing.</p>
<p>This secret is encrypted by the SCS/zuul-config repository RSA key that has been generated by SCS Zuul instance.
So only SCS Zuul instance is able to decrypt it (read the <a href="https://zuul-ci.org/docs/zuul/latest/project-config.html#encryption" target="_blank" rel="noopener noreferrer">docs</a>).</p>
<p>If you want to re-generate the mentioned secret or add another one using SCS/zuul-config repository RSA key, follow the below instructions:</p>
<ul>
<li>Install zuul-client</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip install zuul-client</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Encrypt &quot;super-secret&quot; string by the SCS/zuul-config repository public key from SCS Zuul</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo -n &quot;super-secret&quot; | \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  zuul-client --zuul-url https://zuul.scs.community encrypt \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --tenant SCS \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --project github.com/SovereignCloudStack/zuul-config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="job-customization">Job customization<a href="#job-customization" class="hash-link" aria-label="Direct link to Job customization" title="Direct link to Job customization">​</a></h3>
<p>In a pull request (PR), you may want to run the end-to-end (e2e) test against the specific cluster-stack you are changing or adding, without modifying the <code>cluster_stack</code> variable in the <code>e2e.yaml</code> file in the repository.</p>
<p>To achieve this, include the following text in the body of the PR:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ```ZUUL_CONFIG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cluster_stack = &quot;openstack-alpha-1-29&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; [!NOTE]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt; Please note that only cluster-stacks for OpenStack are currently supported.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">### FAQ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#### How do developers/reviewers should proceed if they want to CI test this project?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A developer initiates a PR as usual. If a reviewer deems that the PR requires e2e testing, they can apply a specific label to the PR. Currently, the following labels could be applied:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- `e2e-test` (for comprehensive end-to-end (e2e) testing, including Kubernetes (k8s) workload cluster creation, execution of Sonobuoy conformance and SCS compliance tests, and cluster deletion.)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- `e2e-quick-test` (for comprehensive end-to-end (e2e) testing, including Kubernetes (k8s) workload cluster creation, execution of Sonobuoy quick and SCS compliance tests, and cluster deletion.)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">After the e2e test has completed, the reviewer can examine the test results and respond accordingly, such as approving the PR if everything appears to be in order or requesting changes. Sonobuoy test results, along with a link to the e2e logs, are conveyed back to the PR via a comment. Additionally, the PR is labeled appropriately based on the overall e2e test results, using labels like</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">`successful-e2e-test`, `successful-e2e-quick-test`, `failed-e2e-test`, or `failed-e2e-quick-test`.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#### Why do we use PR `label` as an e2e pipeline trigger instead of e.g. PR `comment`?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">We consider PR labels to be a more secure pipeline trigger compared to, for example, PR comments.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PR labels can only be applied by developers with [triage](https://docs.github.com/en/organizations/managing-user-access-to-your-organizations-repositories/managing-repository-roles/repository-roles-for-an-organization#permissions-for-each-role) repository access or higher.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">In contrast, PR comments can be added by anyone with a GitHub account.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Members of the SCS GitHub organization are automatically granted &#x27;write&#x27; access to SCS repositories. Consequently, the PR label mechanism ensures that only SCS organization members can trigger e2e pipelines.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#### How do we ensure that any PR update invalidates a previous successful e2e test?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">In fact, two mechanisms ensure the invalidation of a previously successful test when a PR is updated.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Firstly, the pipelines `unlabel-on-update-&lt;e2e-test-name&gt;` remove the `successful-&lt;e2e-test-name&gt;` label</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">from the PR when it&#x27;s updated after a successful e2e test has finished. If an e2e test is in progress and the PR is updated, the currently running e2e test is canceled, the `successful-&lt;e2e-test-name&gt;` label is removed (if it exists), and the `cancelled-&lt;e2e-test-name&gt;` label is applied along with an informative PR comment to inform the reviewer about the situation.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/SovereignCloudStack/docs/tree/main/docs/03-container/components/cluster-stacks/components/cluster-stacks/continuous-integration.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#pipelines" class="table-of-contents__link toc-highlight">Pipelines</a></li><li><a href="#jobs" class="table-of-contents__link toc-highlight">Jobs</a><ul><li><a href="#secrets" class="table-of-contents__link toc-highlight">Secrets</a></li><li><a href="#job-customization" class="table-of-contents__link toc-highlight">Job customization</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@sovereigncloudstack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</div></div></div></footer></div>
</body>
</html>