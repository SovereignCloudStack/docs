<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-container/components/cluster-stacks/components/csctl/design" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">CSCTL - Design document | One platform — standardized, built and operated by many.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" name="twitter:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" property="og:url" content="https://docs.scs.community/docs/container/components/cluster-stacks/components/csctl/design"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CSCTL - Design document | One platform — standardized, built and operated by many."><meta data-rh="true" name="description" content="The Cluster Stack Operator facilitates the usage of cluster stacks by automating all steps that can be automated. It takes cluster stacks release assets that consist mainly of two Helm charts, one to deploy in the management cluster, the other one to deploy in the workload clusters, as well as provider-specific node image (build) information."><meta data-rh="true" property="og:description" content="The Cluster Stack Operator facilitates the usage of cluster stacks by automating all steps that can be automated. It takes cluster stacks release assets that consist mainly of two Helm charts, one to deploy in the management cluster, the other one to deploy in the workload clusters, as well as provider-specific node image (build) information."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/csctl/design"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/csctl/design" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/container/components/cluster-stacks/components/csctl/design" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="One platform — standardized, built and operated by many. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="One platform — standardized, built and operated by many. Atom Feed">








<link rel="preconnect" href="https://matomo.scs.community/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://matomo.scs.community/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","2"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.0eddb8c7.css">
<script src="/assets/js/runtime~main.ede2d0ee.js" defer="defer"></script>
<script src="/assets/js/main.ff9c6252.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/standards">Standards</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">For Operators</a><a class="navbar__item navbar__link" href="/contributor-docs">For Contributors</a><a class="navbar__item navbar__link" href="/user-docs">For Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CSCTL - Design document</h1></header>
<h1>Introduction</h1>
<p>The Cluster Stack Operator facilitates the usage of cluster stacks by automating all steps that can be automated. It takes cluster stacks release assets that consist mainly of two Helm charts, one to deploy in the management cluster, the other one to deploy in the workload clusters, as well as provider-specific node image (build) information.</p>
<p>Users can take existing releases of cluster stacks and the operator and will be able to create clusters easily.</p>
<p>However, there is no clear and nice way to work on cluster stacks, test, and release them.</p>
<p>This proposal will discuss a tool to improve the experience of developers implementing cluster stacks.</p>
<h1>Motivation</h1>
<p>The current process of building cluster stacks is rather cumbersome and error-prone. There are multiple issues with the current approach:</p>
<ol>
<li>The release assets have to follow a very specific (naming) pattern, to be usable with the operator. Currently, they have to be created manually. There are no docs for this manual process.</li>
<li>The cluster stacks can be versioned following the pattern v1, v2, … This is perfect from the user perspective, but not good for people implementing cluster stacks, as they can only do local tests by artificially creating a v2 and not releasing it.</li>
<li>The versioning of the cluster stacks is not easy, as there are multiple versions involved. Cluster addons have their own version, for example. Currently, the versions have to be manually hard-coded in multiple places. This can be validated to some degree but is not developer-friendly and can still lead to mistakes.</li>
</ol>
<h1>Proposal</h1>
<p>We propose a CLI tool called “csctl”, which stands for cluster-stack-manager-ctl. This CLI tool should take over all manual work from a developer implementing cluster stacks that can be taken over. The developer should concentrate only on implementing the cluster stacks themselves.</p>
<p>There will be still a certain way of dealing with “cluster stack-specific” jobs, e.g. following a certain templating pattern. This is necessary, as the configuration and Helm Charts that developers implement are very generic.</p>
<p>The tool should generate release assets, e.g. by using <code>helm package</code> for the helm charts. It should be able to create these release assets for different use cases, e.g. for creating a stable release, for testing a certain commit, and for creating a beta release.</p>
<h1>User stories</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-story-1-developer-releasing-cluster-stacks">User story 1: Developer releasing cluster stacks<a href="#user-story-1-developer-releasing-cluster-stacks" class="hash-link" aria-label="Direct link to User story 1: Developer releasing cluster stacks" title="Direct link to User story 1: Developer releasing cluster stacks">​</a></h3>
<p>A developer who wants to release a cluster stack that was implemented can use the CLI tool to generate all release assets that are required. This should save much time compared to following a manual process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-story-2-developer-versioning-cluster-stacks">User story 2: Developer versioning cluster stacks<a href="#user-story-2-developer-versioning-cluster-stacks" class="hash-link" aria-label="Direct link to User story 2: Developer versioning cluster stacks" title="Direct link to User story 2: Developer versioning cluster stacks">​</a></h3>
<p>A developer who has to think about how to version a cluster stack that was implemented can use the tool to do the job. This saves a lot of time, as the developer would have to manually check whether anything was updated for cluster addons or node images to find the appropriate version (”Did anything change in the cluster addons so that they need a new version or not?”).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-story-3-multiple-developers-work-in-parallel-on-one-cluster-stack">User story 3: Multiple developers work in parallel on one cluster stack<a href="#user-story-3-multiple-developers-work-in-parallel-on-one-cluster-stack" class="hash-link" aria-label="Direct link to User story 3: Multiple developers work in parallel on one cluster stack" title="Direct link to User story 3: Multiple developers work in parallel on one cluster stack">​</a></h3>
<p>If multiple developers work on one cluster stack, they might interfere with each other’s work. Assuming that node images have to be built, then one developer would upload the node images in version “v2”, as the previous version was “v1”. The second developer has the same thought and would either overwrite the already uploaded node images of the colleague or not be able to upload the images since they exist already.</p>
<p>The csctl allows both developers to have independent versioning based on a git commit hash.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-story-4-developer-updating-cluster-stack-that-is-used-in-production">User story 4: Developer updating cluster stack that is used in production<a href="#user-story-4-developer-updating-cluster-stack-that-is-used-in-production" class="hash-link" aria-label="Direct link to User story 4: Developer updating cluster stack that is used in production" title="Direct link to User story 4: Developer updating cluster stack that is used in production">​</a></h3>
<p>If a developer updates a cluster stack that is used in production, great care is needed. The csctl allows the developer to safely test cluster stacks, e.g. with a beta channel, without touching cluster stacks that are used in production.
If everything works well, a production release can be generated with csctl.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-story-5-automated-testing-of-cluster-stacks">User story 5: Automated testing of cluster stacks<a href="#user-story-5-automated-testing-of-cluster-stacks" class="hash-link" aria-label="Direct link to User story 5: Automated testing of cluster stacks" title="Direct link to User story 5: Automated testing of cluster stacks">​</a></h3>
<p>Cluster stacks cannot be tested in the CI and with a normal Git PR flow. The csctl allows this testing of individual PRs and therefore enables automated testing via CI.</p>
<h1>Risks &amp; Mitigations</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="two-forms-of-templating">Two forms of templating<a href="#two-forms-of-templating" class="hash-link" aria-label="Direct link to Two forms of templating" title="Direct link to Two forms of templating">​</a></h3>
<p>Helm charts use Go templating with the notation <code>{{ .values.myvalue }}</code>. As a cluster stack consists usually of two Helm charts, this notation will be very common.</p>
<p>However, the csctl requires a different form of templating, additionally to the one of Helm. This comes from the versioning of the cluster stacks themselves. The Cluster addon version, for example, has to be the version of the respective Helm chart. The same goes for the <code>ClusterClass</code> object name.</p>
<p>Users have to use the additional templating notation <code>&lt;&lt; .ClusterAddonVersion &gt;&gt;</code> while implementing cluster stacks.</p>
<p>The alternative to using a different notation for cluster stack templating would be to use the same one as Helm. However, this will be confusing for users, as they cannot differentiate it. Therefore, we cannot suggest to follow that path.</p>
<h1>Design details</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="generic-vs-provider-specific-work">Generic vs provider-specific work<a href="#generic-vs-provider-specific-work" class="hash-link" aria-label="Direct link to Generic vs provider-specific work" title="Direct link to Generic vs provider-specific work">​</a></h2>
<p>Just like the Cluster Stack Operator, the csctl also has a generic and a provider-specific part. The provider-specific part is optional.</p>
<p>The generic work is done with a CLI tool that exists in the repository csctl in SCS. The tool can be initialized with provider-specific binaries, similar to the way <a href="https://github.com/hashicorp/packer" target="_blank" rel="noopener noreferrer">packer</a> does it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="generic-work">Generic work<a href="#generic-work" class="hash-link" aria-label="Direct link to Generic work" title="Direct link to Generic work">​</a></h2>
<p>The generic part of the csctl is</p>
<ol>
<li>Calculate the right versions based on git commit hash or previous releases</li>
<li>Template everything with csctl templating (NOT Helm templating!!)</li>
<li>Package the ClusterClass Helm Chart</li>
<li>Package the ClusterAddon Helm Chart</li>
<li>Generate metadata.yaml</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="provider-specific-work">Provider-specific work<a href="#provider-specific-work" class="hash-link" aria-label="Direct link to Provider-specific work" title="Direct link to Provider-specific work">​</a></h2>
<p>The provider-specific part of csctl would do anything necessary to provide node images to users. One common task could be to use packer to build images and to upload them somewhere they can be accessed by users.</p>
<p>Of course, one task would also be to find the right version for the node images (e.g. v2 if something changed since v1, or simply the git commit hash)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>There are multiple ways of configuring the csctl. They all have specific use cases and will be explained in the following</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-file">Configuration file<a href="#configuration-file" class="hash-link" aria-label="Direct link to Configuration file" title="Direct link to Configuration file">​</a></h3>
<p>There is a configuration file called <code>csctl.yaml</code> which contains all values that will never have to be changed for a specific cluster stack. It follows this pattern:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> csctl.clusterstack.x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">kubernetesVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> v1.27.7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">clusterStackName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ferrol</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> myprovider</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> myprovider.csctl.clusterstack.x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		</span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> xyz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is mainly the Kubernetes version, the name of the cluster stack, as well as the provider. Additionally, there is a provider-specific configuration. Both the generic and the provider-specific configuration is versioned.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="flags">Flags<a href="#flags" class="hash-link" aria-label="Direct link to Flags" title="Direct link to Flags">​</a></h3>
<p>Via flags the user can specifiy everything that is important but which might change, e.g. the mode “stable” or “hash”, giving you release assets for a stable release or creating release assets based on the latest git commit hash.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-variables">Environment variables<a href="#environment-variables" class="hash-link" aria-label="Direct link to Environment variables" title="Direct link to Environment variables">​</a></h3>
<p>Environment variables can be used, for example, to specify tokens and passwords. csctl has to validate that all required environment variables have been specified.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commands-of-cli-tool">Commands of CLI tool<a href="#commands-of-cli-tool" class="hash-link" aria-label="Direct link to Commands of CLI tool" title="Direct link to Commands of CLI tool">​</a></h2>
<p>Multiple commands can make sense for developers. The most important one is the <code>create</code> command that creates release assets, as well as <code>provider install</code> to install the binary of a provider that carries out all provider-specific work.</p>
<p>This is a full list:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">subcommands</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">provider			Is used for the provider lifecycle			</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">create 				creates release assets of a cluster stack.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">generate			Generates a specific resource from a cluster stack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list 				  show all cluster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">stacks from a repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">version				shows the version of this cli tool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">help				  print a overview of available flags etc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">subcommands for provider</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">install				Installs a cluster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">stack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">release</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">provider at a version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">installed			Lists installed csctl release providers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">remove				removes a csctl release provider at a version `csctl provider remove docker &lt;version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modes">Modes<a href="#modes" class="hash-link" aria-label="Direct link to Modes" title="Direct link to Modes">​</a></h2>
<p>There are multiple modes to create release assets following different versioning patterns.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stable">Stable<a href="#stable" class="hash-link" aria-label="Direct link to Stable" title="Direct link to Stable">​</a></h3>
<p>The stable mode requires the developer to specify an existing GitHub repository (in the future other ways of storing release assets are possible) via environment variables. The csctl will search for the latest release fitting to the configuration of provider, cluster stack name, and Kubernetes version (e.g. docker-ferrol-1-27-vXXX). Then it will download the required release assets and check whether anything has changed in the cluster addon and node image section. Depending on that information it will calculate the next version, e.g. v2 after v1, or will leave the version the same if nothing changed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hash">Hash<a href="#hash" class="hash-link" aria-label="Direct link to Hash" title="Direct link to Hash">​</a></h3>
<p>The hash mode is useful for developing cluster stacks. It will use the hash of the last git commit and generate a version of the form <code>v0-hash.&lt;hash&gt;</code>. following semver.</p>
<p>This version will be used for cluster class, cluster add-ons, and node images. Unlike the stable version, the versions in hash mode always update to the latest commit and do not depend on any previous release.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="beta">Beta<a href="#beta" class="hash-link" aria-label="Direct link to Beta" title="Direct link to Beta">​</a></h3>
<p>The beta mode is similar to the stable mode, except that it generates releases following the version pattern <code>v0-beta.0</code>, <code>v0-beta.1</code>, etc.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-eg-for-prs">Custom (e.g. for PRs)<a href="#custom-eg-for-prs" class="hash-link" aria-label="Direct link to Custom (e.g. for PRs)" title="Direct link to Custom (e.g. for PRs)">​</a></h3>
<p>The custom mode is designed for PR purposes and supports automated testing. It accommodates versions formatted as v0.custom-pr123. Crucially, these versions must adhere to semantic versioning standards (semver) and are specifically intended as inputs for the csctl tool.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/SovereignCloudStack/docs/tree/main/docs/03-container/components/cluster-stacks/components/csctl/design.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#user-story-1-developer-releasing-cluster-stacks" class="table-of-contents__link toc-highlight">User story 1: Developer releasing cluster stacks</a></li><li><a href="#user-story-2-developer-versioning-cluster-stacks" class="table-of-contents__link toc-highlight">User story 2: Developer versioning cluster stacks</a></li><li><a href="#user-story-3-multiple-developers-work-in-parallel-on-one-cluster-stack" class="table-of-contents__link toc-highlight">User story 3: Multiple developers work in parallel on one cluster stack</a></li><li><a href="#user-story-4-developer-updating-cluster-stack-that-is-used-in-production" class="table-of-contents__link toc-highlight">User story 4: Developer updating cluster stack that is used in production</a></li><li><a href="#user-story-5-automated-testing-of-cluster-stacks" class="table-of-contents__link toc-highlight">User story 5: Automated testing of cluster stacks</a></li><li><a href="#two-forms-of-templating" class="table-of-contents__link toc-highlight">Two forms of templating</a></li><li><a href="#generic-vs-provider-specific-work" class="table-of-contents__link toc-highlight">Generic vs provider-specific work</a></li><li><a href="#generic-work" class="table-of-contents__link toc-highlight">Generic work</a></li><li><a href="#provider-specific-work" class="table-of-contents__link toc-highlight">Provider-specific work</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#configuration-file" class="table-of-contents__link toc-highlight">Configuration file</a></li><li><a href="#flags" class="table-of-contents__link toc-highlight">Flags</a></li><li><a href="#environment-variables" class="table-of-contents__link toc-highlight">Environment variables</a></li></ul></li><li><a href="#commands-of-cli-tool" class="table-of-contents__link toc-highlight">Commands of CLI tool</a></li><li><a href="#modes" class="table-of-contents__link toc-highlight">Modes</a><ul><li><a href="#stable" class="table-of-contents__link toc-highlight">Stable</a></li><li><a href="#hash" class="table-of-contents__link toc-highlight">Hash</a></li><li><a href="#beta" class="table-of-contents__link toc-highlight">Beta</a></li><li><a href="#custom-eg-for-prs" class="table-of-contents__link toc-highlight">Custom (e.g. for PRs)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@sovereigncloudstack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</div></div></div></footer></div>
</body>
</html>