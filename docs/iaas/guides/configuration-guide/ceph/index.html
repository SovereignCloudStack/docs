<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-iaas/guides/configuration-guide/ceph/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Ceph | One platform — standardized, built and operated by many.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" name="twitter:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" property="og:url" content="https://docs.scs.community/docs/iaas/guides/configuration-guide/ceph/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ceph | One platform — standardized, built and operated by many."><meta data-rh="true" name="description" content="The official Ceph documentation is located on https://docs.ceph.com/en/latest/rados/configuration/"><meta data-rh="true" property="og:description" content="The official Ceph documentation is located on https://docs.ceph.com/en/latest/rados/configuration/"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scs.community/docs/iaas/guides/configuration-guide/ceph/"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/iaas/guides/configuration-guide/ceph/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scs.community/docs/iaas/guides/configuration-guide/ceph/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"IaaS Layer","item":"https://docs.scs.community/docs/category/iaas-layer"},{"@type":"ListItem","position":2,"name":"Configuration Guide","item":"https://docs.scs.community/docs/iaas/guides/configuration-guide/"},{"@type":"ListItem","position":3,"name":"Ceph","item":"https://docs.scs.community/docs/iaas/guides/configuration-guide/ceph/"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SCS Community Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SCS Community Blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="SCS Community Blog JSON Feed">









<link rel="preconnect" href="https://matomo.scs.community/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://matomo.scs.community/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","2"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.7136250c.css">
<script src="/assets/js/runtime~main.ff722ccb.js" defer="defer"></script>
<script src="/assets/js/main.6cc1e574.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/standards">Standards</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">For Operators</a><a class="navbar__item navbar__link" href="/contributor-docs">For Contributors</a><a class="navbar__item navbar__link" href="/user-docs">For Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/category/iaas-layer"><span title="IaaS Layer" class="categoryLinkLabel_W154">IaaS Layer</span></a><button aria-label="Collapse sidebar category &#x27;IaaS Layer&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/iaas/guides/concept-guide/"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/concept-guide/"><span title="Concept Guide" class="categoryLinkLabel_W154">Concept Guide</span></a><button aria-label="Expand sidebar category &#x27;Concept Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/deploy-guide/"><span title="Deploy Guide" class="categoryLinkLabel_W154">Deploy Guide</span></a><button aria-label="Expand sidebar category &#x27;Deploy Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/upgrade-guide/"><span title="Upgrade Guide" class="categoryLinkLabel_W154">Upgrade Guide</span></a><button aria-label="Expand sidebar category &#x27;Upgrade Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/iaas/guides/configuration-guide/"><span title="Configuration Guide" class="categoryLinkLabel_W154">Configuration Guide</span></a><button aria-label="Collapse sidebar category &#x27;Configuration Guide&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/configuration-repository"><span title="Configuration repository" class="linkLabel_WmDU">Configuration repository</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/inventory"><span title="Inventory" class="linkLabel_WmDU">Inventory</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/manager"><span title="Manager" class="linkLabel_WmDU">Manager</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/network"><span title="Network" class="linkLabel_WmDU">Network</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/proxy"><span title="Proxy" class="linkLabel_WmDU">Proxy</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/loadbalancer"><span title="Loadbalancer" class="linkLabel_WmDU">Loadbalancer</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/docs/iaas/guides/configuration-guide/ceph/"><span title="Ceph" class="categoryLinkLabel_W154">Ceph</span></a><button aria-label="Collapse sidebar category &#x27;Ceph&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/ceph/rook"><span title="Configuration for Rook" class="linkLabel_WmDU">Configuration for Rook</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/configuration-guide/openstack/"><span title="OpenStack" class="categoryLinkLabel_W154">OpenStack</span></a><button aria-label="Expand sidebar category &#x27;OpenStack&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/configuration-guide/commons/"><span title="Commons" class="categoryLinkLabel_W154">Commons</span></a><button aria-label="Expand sidebar category &#x27;Commons&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/configuration-guide/services/"><span title="Services" class="categoryLinkLabel_W154">Services</span></a><button aria-label="Expand sidebar category &#x27;Services&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/validations/"><span title="Validations" class="linkLabel_WmDU">Validations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/baremetal/"><span title="Baremetal" class="linkLabel_WmDU">Baremetal</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/configuration-guide/sonic/"><span title="SONiC" class="linkLabel_WmDU">SONiC</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/operations-guide/"><span title="Operations Guide" class="categoryLinkLabel_W154">Operations Guide</span></a><button aria-label="Expand sidebar category &#x27;Operations Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/troubleshooting-guide/"><span title="Troubleshooting Guide" class="categoryLinkLabel_W154">Troubleshooting Guide</span></a><button aria-label="Expand sidebar category &#x27;Troubleshooting Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iaas/guides/"><span title="Guides" class="linkLabel_WmDU">Guides</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/user-guide/"><span title="User Guide" class="categoryLinkLabel_W154">User Guide</span></a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/developer-guide/"><span title="Developer Guide" class="categoryLinkLabel_W154">Developer Guide</span></a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/iaas/guides/migration-guide/"><span title="Migration Guide" class="categoryLinkLabel_W154">Migration Guide</span></a><button aria-label="Expand sidebar category &#x27;Migration Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/components"><span title="Components" class="categoryLinkLabel_W154">Components</span></a><button aria-label="Expand sidebar category &#x27;Components&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/deployment-examples"><span title="Deployment Examples" class="categoryLinkLabel_W154">Deployment Examples</span></a><button aria-label="Expand sidebar category &#x27;Deployment Examples&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/container/"><span title="Container Layer" class="categoryLinkLabel_W154">Container Layer</span></a><button aria-label="Expand sidebar category &#x27;Container Layer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/operating-scs"><span title="Operating SCS" class="categoryLinkLabel_W154">Operating SCS</span></a><button aria-label="Expand sidebar category &#x27;Operating SCS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/iam/"><span title="Identity and Access Management (IAM)" class="categoryLinkLabel_W154">Identity and Access Management (IAM)</span></a><button aria-label="Expand sidebar category &#x27;Identity and Access Management (IAM)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/turnkey-solution"><span title="Turnkey Solution" class="categoryLinkLabel_W154">Turnkey Solution</span></a><button aria-label="Expand sidebar category &#x27;Turnkey Solution&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/releases"><span title="Releases" class="categoryLinkLabel_W154">Releases</span></a><button aria-label="Expand sidebar category &#x27;Releases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq/"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary"><span title="Glossary" class="linkLabel_WmDU">Glossary</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/iaas-layer"><span>IaaS Layer</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/iaas/guides/configuration-guide/"><span>Configuration Guide</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Ceph</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ceph</h1></header>
<p>The official Ceph documentation is located on <a href="https://docs.ceph.com/en/latest/rados/configuration/" target="_blank" rel="noopener noreferrer" class="">https://docs.ceph.com/en/latest/rados/configuration/</a></p>
<p>It is <strong>strongly advised</strong> to use the documentation for the version being used.</p>
<ul>
<li class="">Pacific - <a href="https://docs.ceph.com/en/pacific/rados/configuration/" target="_blank" rel="noopener noreferrer" class="">https://docs.ceph.com/en/pacific/rados/configuration/</a></li>
<li class="">Quincy - <a href="https://docs.ceph.com/en/quincy/rados/configuration/" target="_blank" rel="noopener noreferrer" class="">https://docs.ceph.com/en/quincy/rados/configuration/</a></li>
<li class="">Reef - <a href="https://docs.ceph.com/en/reef/rados/configuration/" target="_blank" rel="noopener noreferrer" class="">https://docs.ceph.com/en/reef/rados/configuration/</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="unique-identifier">Unique Identifier<a href="#unique-identifier" class="hash-link" aria-label="Direct link to Unique Identifier" title="Direct link to Unique Identifier" translate="no">​</a></h2>
<p>The File System ID is a unique identifier for the cluster.
The identifier is set via the parameter <code>fsid</code> in <code>environments/ceph/configuration.yml</code>
and must be unique. It can be generated with <code>uuidgen</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">fsid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> c2120a4a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">669c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4769</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">a32c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b7e9d7b848f4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="client">Client<a href="#client" class="hash-link" aria-label="Direct link to Client" title="Direct link to Client" translate="no">​</a></h2>
<p>The <code>client.admin</code> keyring is placed in the file <code>environments/infrastructure/files/ceph/ceph.client.admin.keyring</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="swappiness">Swappiness<a href="#swappiness" class="hash-link" aria-label="Direct link to Swappiness" title="Direct link to Swappiness" translate="no">​</a></h2>
<p>The swappiness is set via the <code>os_tuning_params</code> dictionary. The dictionary can
only be completely overwritten via an entry in the file <code>environments/ceph/configuration.yml</code>.</p>
<p>By default, the dictionary looks like this. If the swappiness of <code>10</code> is to be used, it is not
necessary to add the <code>os_tuning_params</code> dictionary to the configuration repository. This is only
necessary if the swappiness is to be customized.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">os_tuning_params</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> fs.file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">26234859</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> vm.zone_reclaim_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> vm.swappiness</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> vm.min_free_kbytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ vm_min_free_kbytes }}&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<p>The sysctl parameters are written to the file <code>/etc/sysctl.d/ceph-tuning.conf</code>
on the storage nodes.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cat /etc/sysctl.d/ceph-tuning.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fs.aio-max-nr=1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fs.file-max=26234859</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vm.zone_reclaim_mode=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vm.swappiness=10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vm.min_free_kbytes=4194303</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="rgw-service">RGW service<a href="#rgw-service" class="hash-link" aria-label="Direct link to RGW service" title="Direct link to RGW service" translate="no">​</a></h2>
<ol>
<li class="">
<p>Add following configuration in <code>environments/ceph/configuration.yml</code></p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">OSISM &gt;= 9.0.0</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">OSISM &lt; 9.0.0</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_conf_overrides</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&quot;client.rgw.{{ rgw_zone }}.{{ hostvars[inventory_hostname][&#x27;ansible_hostname&#x27;] }}.rgw0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw content length compat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw enable apis&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;swift, s3, admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone accepted roles&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;member, admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone accepted admin roles&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin domain&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;default&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin password&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ceph_rgw_keystone_password }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin project&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;service&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin tenant&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;service&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ceph_rgw&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone api version&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone url&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://api-int.testbed.osism.xyz:5000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone verify ssl&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;false&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone implicit tenants&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw s3 auth use keystone&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw swift account in url&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw swift versioning enabled&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_conf_overrides</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">&quot;client.rgw.{{ hostvars[inventory_hostname][&#x27;ansible_hostname&#x27;] }}.rgw0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw content length compat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw enable apis&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;swift, s3, admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone accepted roles&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;member, admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone accepted admin roles&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin domain&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;default&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin password&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ceph_rgw_keystone_password }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin project&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;service&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin tenant&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;service&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone admin user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ceph_rgw&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone api version&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone url&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://api-int.testbed.osism.xyz:5000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone verify ssl&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;false&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw keystone implicit tenants&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw s3 auth use keystone&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw swift account in url&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">&quot;rgw swift versioning enabled&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><br></span></code></pre></div></div></div></div></div>
<p>If the <code>ceph_conf_overrides</code> parameter already exists in <code>environments/ceph/configuration.yml</code>,
expand it and do not overwrite it.</p>
<p>If self-signed SSL certificates are used, two additional parameters must be set.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token key atrule">&quot;rgw keystone verify ssl&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;false&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token key atrule">&quot;rgw verify ssl&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;false&quot;</span><br></span></code></pre></div></div>
<p>For all possible configuration parameters visit the
<a href="https://docs.ceph.com/en/quincy/radosgw/config-ref/" target="_blank" rel="noopener noreferrer" class="">Ceph configuration reference</a>.</p>
</li>
<li class="">
<p>Add the <code>ceph_rgw_keystone_password</code> from <code>environments/kolla/secrets.yml</code> to
<code>environments/ceph/secrets.yml</code>.</p>
</li>
<li class="">
<p>Add following configuration in <code>environments/kolla/configuration.yml</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/kolla/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">enable_ceph_rgw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">enable_ceph_rgw_keystone</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rgw_swift_compatibility</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rgw_swift_account_in_url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>On the nodes on which the RGW service is to be deployed, <code>radosgw_interface</code> <strong>or</strong>
<code>radosgw_address</code> must be set in the host vars for the nodes in the inventory.
If <code>radosgw_interface</code> is used, the first IPv4 address on this interface is used.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">##########################################################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ceph</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">radosgw_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 192.168.16.10</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>The nodes on which the RGW service is to be deployed can be defined in inventory group
<code>ceph-rgw</code>. By default, the RGW services are deployed on the Ceph control nodes..</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">inventory/20-roles</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ceph-rgw:children]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-control</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="pools-and-keys">Pools and Keys<a href="#pools-and-keys" class="hash-link" aria-label="Direct link to Pools and Keys" title="Direct link to Pools and Keys" translate="no">​</a></h2>
<p>The defaults for pools are defined in the <a href="https://github.com/osism/defaults/blob/main/all/099-ceph.yml" target="_blank" rel="noopener noreferrer" class="">osism/defaults</a>
repository:</p>
<table><thead><tr><th style="text-align:left">Parameter</th><th style="text-align:left">Default value</th></tr></thead><tbody><tr><td style="text-align:left"><code>openstack_pool_default_min_size</code></td><td style="text-align:left">0</td></tr><tr><td style="text-align:left"><code>openstack_pool_default_pg_autoscale_mode</code></td><td style="text-align:left">false</td></tr><tr><td style="text-align:left"><code>openstack_pool_default_pg_num</code></td><td style="text-align:left">64</td></tr><tr><td style="text-align:left"><code>openstack_pool_default_rule_name</code></td><td style="text-align:left"><code>replicated_rule</code></td></tr><tr><td style="text-align:left"><code>openstack_pool_default_size</code></td><td style="text-align:left">3</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The autoscaler for pools is not enabled by default and the number of PGs used when creating
a pool is very low. Either you enable the autoscaler by default or you have to
<a class="" href="/docs/iaas/guides/operations-guide/ceph/#set-number-of-pgs-for-a-pool">adjust the number of PGs</a>
accordingly after the initial creation of the pools.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="extra-pools">Extra pools<a href="#extra-pools" class="hash-link" aria-label="Direct link to Extra pools" title="Direct link to Extra pools" translate="no">​</a></h3>
<p>Extra pools can be defined via the <code>openstack_pools_extra</code> parameter.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">openstack_extra001_pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> extra001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">pg_num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_pool_default_pg_num }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">pgp_num</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_pool_default_pg_num }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">rule_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replicated_rule&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">erasure_profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">expected_num_objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">application</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rbd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_pool_default_size }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">min_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_pool_default_min_size }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">pg_autoscale_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_pool_default_pg_autoscale_mode }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">openstack_pools_extra</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_extra001_pool }}&quot;</span><br></span></code></pre></div></div>
<p>If more than one Ceph cluster is managed with one manager, do not place the
parameters in <code>environments/ceph/configuration.yml</code> but in a corresponding file.</p>
<p>The extra pools can then be created by calling <code>osism apply ceph-pools</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="extra-keys">Extra keys<a href="#extra-keys" class="hash-link" aria-label="Direct link to Extra keys" title="Direct link to Extra keys" translate="no">​</a></h3>
<p>Extra keys can be defined via the <code>openstack_keys_extra</code> parameter.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">openstack_extra001_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> client.extra001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">caps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">mon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;profile rbd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;profile rbd pool={{ openstack_extra001_pool.name }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0600&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">openstack_keys_extra</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ openstack_extra001_key }}&quot;</span><br></span></code></pre></div></div>
<p>The key is also added in the manager environment to copy it to the correct location.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/manager/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_custom_keys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">src</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.client.extra001.keyring</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">dest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ configuration_directory }}/environments/infrastructure/files/ceph/ceph.client.extra001.keyring&quot;</span><br></span></code></pre></div></div>
<p>The extra keys can then be created by calling <code>osism apply ceph-pools</code>.</p>
<p>The extra keys can then be fetched and copied by calling <code>osism apply ceph-copy-keys</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="osd-devices">OSD devices<a href="#osd-devices" class="hash-link" aria-label="Direct link to OSD devices" title="Direct link to OSD devices" translate="no">​</a></h2>
<ol>
<li class="">
<p>For each Ceph storage node edit the file <code>inventory/host_vars/&lt;nodename&gt;.yml</code>
add a configuration like the following to it. Ensure that no <code>devices</code> parameter
is present in the file.</p>
<ol>
<li class="">
<p>Parameters</p>
<ul>
<li class="">
<p>With the optional parameter <code>ceph_osd_db_wal_devices_buffer_space_percent</code> it is possible to
set the percentage of VGs to leave free. The parameter is not set by default. Can be helpful
for SSD performance of some older SSD models or to extend lifetime of SSDs in general.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_db_wal_devices_buffer_space_percent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">10</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>It is possible to configure the devices to be used with the parameters <code>ceph_osd_devices</code>,
<code>ceph_db_devices</code>, <code>ceph_wal_devices</code>, and <code>ceph_db_wal_devices</code>. This is described below.</p>
</li>
<li class="">
<p>It is always possible to use device names such as <code>sda</code> or device IDs such as
<code>disk/by-id/wwn-&lt;something&gt;</code> or <code>disk/by-id/nvme-eui.&lt;something&gt;</code>. <code>/dev/</code> is not
prefixed and is added automatically.</p>
</li>
<li class="">
<p>The <code>db_size</code> parameter is optional and defaults to <code>(VG size - buffer space (if enabled)) / num_osds</code>.</p>
</li>
<li class="">
<p>The <code>wal_size</code> parameter is optional and defaults to <code>2 GB</code>.</p>
</li>
<li class="">
<p>The <code>num_osds</code> parameter specifies the maximum number of OSDs that can be assigned to a WAL device or DB device.</p>
</li>
<li class="">
<p>The optional parameter <code>wal_pv</code> can be used to set the device that is to be used as the WAL device.</p>
</li>
<li class="">
<p>The optional parameter <code>db_pv</code> can be used to set the device that is to be used as the DB device.</p>
</li>
</ul>
</li>
<li class="">
<p>OSD only</p>
<p>The <code>sda</code> device will be used as an OSD device without WAL and DB device.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>OSD + DB device</p>
<p>The <code>nvme0n1</code> device will be used as an DB device. It is possible to use this DB device for up to 6 OSDs. Each
OSD is provided with 30 GB.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_db_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">nvme0n1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 30 GB</span><br></span></code></pre></div></div>
<p>The <code>sda</code> device will be used as an OSD device with <code>nvme0n1</code> as DB device.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme0n1</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>OSD + WAL device</p>
<p>The <code>nvme0n1</code> device will be used as an WAL device. It is possible to use this WAL device for up to 6 OSDs. Each
OSD is provided with 2 GB.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_wal_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">nvme0n1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">wal_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 2 GB</span><br></span></code></pre></div></div>
<p>The <code>sda</code> device will be used as an OSD device with <code>nvme0n1</code> as WAL device.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">wal_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme0n1</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>OSD + DB device + WAL device (same device for DB + WAL)</p>
<p>The <code>nvme0n1</code> device will be used as an DB device and a WAL device. It is possible to use those devices for up
to 6 OSDs.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_db_wal_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">nvme0n1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 30 GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">wal_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 2 GB</span><br></span></code></pre></div></div>
<p>The <code>sda</code> device will be used as an OSD device with <code>nvme0n1</code> as DB device and <code>nvme0n1</code> as WAL device.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme0n1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">wal_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme0n1</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>OSD + DB device + WAL device (different device for DB + WAL)</p>
<p>The <code>nvme0n1</code> device will be used as an DB device. It is possible to use this DB device for up to 6 OSDs. Each
OSD is provided with 30 GB.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_db_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">nvme0n1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 30 GB</span><br></span></code></pre></div></div>
<p>The <code>nvme1n1</code> device will be used as an WAL device. It is possible to use this WAL device for up to 6 OSDs. Each
OSD is provided with 2 GB.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_wal_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">nvme1n1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">wal_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 2 GB</span><br></span></code></pre></div></div>
<p>The <code>sda</code> device will be used as an OSD device with <code>nvme0n1</code> as DB device and <code>nvme1n1</code> as WAL device.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme0n1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token key atrule">wal_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nvme1n1</span><br></span></code></pre></div></div>
</li>
</ol>
</li>
<li class="">
<p>Push the configuration to your configuration repository and after that do the following</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply facts</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>After the configuration has been pulled and facts updated,
you can run the LVM configuration playbook:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-configure-lvm-volumes</span><br></span></code></pre></div></div>
<p>This will generate a new configuration file for each node in <code>/tmp</code>
on the first manager node named <code>&lt;nodename&gt;-ceph-lvm-configuration.yml</code>.</p>
</li>
<li class="">
<p>Take the generated configuration file from <code>/tmp</code> and <strong>replace the previously
configuration</strong> for each node.</p>
<p>In this example, the following content was in the host vars file before
<code>osism apply ceph-configure-lvm-volumes</code> was called.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><br></span></code></pre></div></div>
<p>The following content has now been generated in the file in the <code>/tmp</code> directory by running
<code>osism apply ceph-configure-lvm-volumes</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 196aad32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">7cc4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5350</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8a45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1b03f50fc9bb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> c6df96be</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1264</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5815</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">9cb2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">da5eb453a6de</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">196aad32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">7cc4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5350</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8a45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1b03f50fc9bb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">196aad32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">7cc4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5350</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8a45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1b03f50fc9bb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c6df96be</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1264</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5815</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">9cb2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">da5eb453a6de</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c6df96be</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1264</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5815</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">9cb2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">da5eb453a6de</span><br></span></code></pre></div></div>
<p>This content from the file in the <code>/tmp</code> directory is added in the host vars file.
The previous <code>ceph_osd_devices</code> is replaced with the new content.</p>
</li>
<li class="">
<p>Push the updated configuration <strong>again</strong> to your configuration repository and re-run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply configuration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Finally create the LVM devices.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-create-lvm-devices</span><br></span></code></pre></div></div>
<p>These PVs, VGs and LVs are created using the example from step 4.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PV         VG                                        Fmt  Attr PSize   PFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb   ceph-196aad32-7cc4-5350-8a45-1b03f50fc9bb lvm2 a--  &lt;20.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdc   ceph-c6df96be-1264-5815-9cb2-da5eb453a6de lvm2 a--  &lt;20.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo vgs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VG                                        #PV #LV #SN Attr   VSize   VFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-196aad32-7cc4-5350-8a45-1b03f50fc9bb   1   1   0 wz--n- &lt;20.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-c6df96be-1264-5815-9cb2-da5eb453a6de   1   1   0 wz--n- &lt;20.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo lvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LV                                             VG                                        Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-196aad32-7cc4-5350-8a45-1b03f50fc9bb ceph-196aad32-7cc4-5350-8a45-1b03f50fc9bb -wi-a----- &lt;20.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-c6df96be-1264-5815-9cb2-da5eb453a6de ceph-c6df96be-1264-5815-9cb2-da5eb453a6de -wi-a----- &lt;20.00g</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Everything is now ready for the deployment of the OSDs.
Details on deploying Ceph in the <a class="" href="/docs/iaas/guides/deploy-guide/services/ceph/">Ceph Deploy Guide</a>.</p>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="full-examples">Full examples<a href="#full-examples" class="hash-link" aria-label="Direct link to Full examples" title="Direct link to Full examples" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="use-of-dedicated-db-devices">Use of dedicated DB devices<a href="#use-of-dedicated-db-devices" class="hash-link" aria-label="Direct link to Use of dedicated DB devices" title="Direct link to Use of dedicated DB devices" translate="no">​</a></h4>
<p>The <code>ceph_osd_devices</code> and <code>ceph_db_devices</code> parameters with the following content are initially added
in the host vars of the node. Devices <code>/dev/sda</code> and <code>/dev/sdb</code> are used as OSD devices. The device <code>/dev/sdd</code>
is used as a DB device for up to 2 OSDs. For each OSD that uses <code>/dev/sdd</code> as DB device, an LV volume of
(in this case) 30 GByte is created. Please note that at least 30 GByte must be used for a DB device in production.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_db_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 30 GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> sdd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> sdd</span><br></span></code></pre></div></div>
<p>Then generate the required LVM2 device configuration with the <code>ceph-configure-lvm-volumes</code> play.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply facts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-configure-lvm-volumes</span><br></span></code></pre></div></div>
<p>Check the <code>/tmp</code> directory on the manager node for files like <code>testbed-node-0.testbed.osism.xyz-ceph-lvm-configuration.yml</code>.
Add this content to the host vars of the corresponding node. The existing <code>ceph_osd_devices</code> parameter is replaced.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># This is Ceph LVM configuration for testbed-node-0.testbed.osism.xyz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># generated by ceph-configure-lvm-volumes playbook.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_db_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 30 GB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">num_osds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">vg_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">eb7522b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">41cf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">522e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8d7e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2a4a82a879bb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> sdd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 75960289</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2e0e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">525d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8bb5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dd8552531ef5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">db_pv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> sdd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ce2c2cb6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">f911</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">52dd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b57f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4476bf7afe9f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">75960289</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2e0e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">525d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8bb5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dd8552531ef5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">75960289</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2e0e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">525d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8bb5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dd8552531ef5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">75960289</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2e0e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">525d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8bb5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dd8552531ef5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">db_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">eb7522b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">41cf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">522e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8d7e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2a4a82a879bb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ce2c2cb6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">f911</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">52dd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b57f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4476bf7afe9f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ce2c2cb6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">f911</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">52dd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b57f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4476bf7afe9f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ce2c2cb6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">f911</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">52dd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b57f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">4476bf7afe9f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">db_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">eb7522b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">41cf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">522e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8d7e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2a4a82a879bb</span><br></span></code></pre></div></div>
<p>Finally, create the necessary PVs, VGs and LVs. The parameter <code>-e ignore_db_too_small=true</code> is only set
here in the example because we use less than 30 GByte for the size of the DB LV.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-create-lvm-devices -e ignore_db_too_small=true</span><br></span></code></pre></div></div>
<p>You can check the PVs, VGs, and LVs on the node.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PV         VG                                           Fmt  Attr PSize   PFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb   ceph-75960289-2e0e-525d-8bb5-dd8552531ef5    lvm2 a--  &lt;20.00g      0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdc   ceph-ce2c2cb6-f911-52dd-b57f-4476bf7afe9f    lvm2 a--  &lt;20.00g      0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdd   ceph-db-eb7522b1-41cf-522e-8d7e-2a4a82a879bb lvm2 a--  &lt;20.00g &lt;10.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo vgs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VG                                           #PV #LV #SN Attr   VSize   VFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-75960289-2e0e-525d-8bb5-dd8552531ef5      1   1   0 wz--n- &lt;20.00g      0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-ce2c2cb6-f911-52dd-b57f-4476bf7afe9f      1   1   0 wz--n- &lt;20.00g      0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-db-eb7522b1-41cf-522e-8d7e-2a4a82a879bb   1   2   0 wz--n- &lt;20.00g &lt;10.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo lvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LV                                             VG                                           Attr       LSize   [...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-75960289-2e0e-525d-8bb5-dd8552531ef5 ceph-75960289-2e0e-525d-8bb5-dd8552531ef5    -wi-a----- &lt;20.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-ce2c2cb6-f911-52dd-b57f-4476bf7afe9f ceph-ce2c2cb6-f911-52dd-b57f-4476bf7afe9f    -wi-a----- &lt;20.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-db-75960289-2e0e-525d-8bb5-dd8552531ef5    ceph-db-eb7522b1-41cf-522e-8d7e-2a4a82a879bb -wi-a-----   5.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-db-ce2c2cb6-f911-52dd-b57f-4476bf7afe9f    ceph-db-eb7522b1-41cf-522e-8d7e-2a4a82a879bb -wi-a-----   5.00g</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="use-of-partitions">Use of partitions<a href="#use-of-partitions" class="hash-link" aria-label="Direct link to Use of partitions" title="Direct link to Use of partitions" translate="no">​</a></h4>
<p>The use of partitions presented in this example is not recommended for use in production but only for POCs.</p>
<p>First create partitions that should be used for Ceph. In this example we use a block device <code>/dev/sdb</code>
with four partitions that will be used for Ceph OSDs.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo fdisk -l /dev/sdb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk /dev/sdb: 20 GiB, 21474836480 bytes, 41943040 sectors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk model: QEMU HARDDISK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Units: sectors of 1 * 512 = 512 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sector size (logical/physical): 512 bytes / 512 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disklabel type: gpt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk identifier: 709B8C6C-51E1-4644-9ED4-0604607FCCEE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Device        Start      End  Sectors Size Type</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb1      2048 10487807 10485760   5G Linux filesystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb2  10487808 20973567 10485760   5G Linux filesystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb3  20973568 31459327 10485760   5G Linux filesystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb4  31459328 41943006 10483679   5G Linux filesystem</span><br></span></code></pre></div></div>
<p>The <code>ceph_osd_devices</code> parameter with the following content is initially added in the host vars of the node.
The partitions <code>/dev/sda1</code>, <code>/dev/sdb1</code>, <code>/dev/sdc1</code> and <code>/dev/sdd1</code>, are to be used as OSD.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  sdb4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><br></span></code></pre></div></div>
<p>Then generate the required LVM2 device configuration with the <code>ceph-configure-lvm-volumes</code> play.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply facts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-configure-lvm-volumes</span><br></span></code></pre></div></div>
<p>Check the <code>/tmp</code> directory on the manager node for files like <code>testbed-node-0.testbed.osism.xyz-ceph-lvm-configuration.yml</code>.
Add this content to the host vars of the corresponding node. The existing <code>ceph_osd_devices</code> parameter is replaced.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># This is Ceph LVM configuration for testbed-node-0.testbed.osism.xyz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># generated by ceph-configure-lvm-volumes playbook.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 9e8799ae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c716</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5212</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8833</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">49f153ffbcef</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 8518d3a2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">3194</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5764</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b55a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c51222b9b576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> a0da232a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">e5b8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5823</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8c42</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8fb231442edc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 56f7b5bc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">82b0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5626</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">90a5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">adf6078ceba6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">9e8799ae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c716</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5212</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8833</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">49f153ffbcef</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">9e8799ae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c716</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5212</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8833</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">49f153ffbcef</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8518d3a2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">3194</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5764</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b55a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c51222b9b576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8518d3a2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">3194</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5764</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b55a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">c51222b9b576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">a0da232a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">e5b8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5823</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8c42</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8fb231442edc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">a0da232a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">e5b8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5823</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8c42</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8fb231442edc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">56f7b5bc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">82b0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5626</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">90a5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">adf6078ceba6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">56f7b5bc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">82b0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5626</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">90a5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">adf6078ceba6</span><br></span></code></pre></div></div>
<p>Finally, create the necessary PVs, VGs and LVs.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism reconciler sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-create-lvm-devices</span><br></span></code></pre></div></div>
<p>You can check the PVs, VGs, and LVs on the node.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PV         VG                                        Fmt  Attr PSize  PFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb1  ceph-9e8799ae-c716-5212-8833-49f153ffbcef lvm2 a--  &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb2  ceph-8518d3a2-3194-5764-b55a-c51222b9b576 lvm2 a--  &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb3  ceph-a0da232a-e5b8-5823-8c42-8fb231442edc lvm2 a--  &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/dev/sdb4  ceph-56f7b5bc-82b0-5626-90a5-adf6078ceba6 lvm2 a--  &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo vgs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VG                                        #PV #LV #SN Attr   VSize  VFree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-56f7b5bc-82b0-5626-90a5-adf6078ceba6   1   1   0 wz--n- &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-8518d3a2-3194-5764-b55a-c51222b9b576   1   1   0 wz--n- &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-9e8799ae-c716-5212-8833-49f153ffbcef   1   1   0 wz--n- &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ceph-a0da232a-e5b8-5823-8c42-8fb231442edc   1   1   0 wz--n- &lt;5.00g    0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo lvs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LV                                             VG                                        Attr       LSize  [...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-56f7b5bc-82b0-5626-90a5-adf6078ceba6 ceph-56f7b5bc-82b0-5626-90a5-adf6078ceba6 -wi-a----- &lt;5.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-8518d3a2-3194-5764-b55a-c51222b9b576 ceph-8518d3a2-3194-5764-b55a-c51222b9b576 -wi-a----- &lt;5.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-9e8799ae-c716-5212-8833-49f153ffbcef ceph-9e8799ae-c716-5212-8833-49f153ffbcef -wi-a----- &lt;5.00g</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">osd-block-a0da232a-e5b8-5823-8c42-8fb231442edc ceph-a0da232a-e5b8-5823-8c42-8fb231442edc -wi-a----- &lt;5.00g</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="add-a-new-osd">Add a new osd<a href="#add-a-new-osd" class="hash-link" aria-label="Direct link to Add a new osd" title="Direct link to Add a new osd" translate="no">​</a></h3>
<ol>
<li class="">
<p>There is the following existing configuration in <code>inventory/host_vars/&lt;nodename&gt;.yml</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>The block device <code>sdc</code> should be added as new OSD on <code>nodename</code>. Edit the existing
configuration in <code>inventory/host_vars/&lt;nodename&gt;.yml</code> and add <code>sdc</code> to the list
<code>ceph_osd_devices</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Commit changes in the configuration repository, sync the configuration repository on
the manager and reconcile the inventory with <code>osism reconciler sync</code>.</p>
</li>
<li class="">
<p>Regenerate the configuration with <code>osism apply ceph-configure-lvm-volumes -l &lt;nodename&gt;</code>.
Synchronize the contents of <code>/tmp/&lt;nodename&gt;-ceph-lvm-configuration.yml</code> with those in
<code>inventory/host_vars/&lt;nodename&gt;.yml</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_osd_devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sda</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">lvm_volumes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">71e54cfb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">65e5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">5109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8f09</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">2be6b661f39c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">acb56e1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">0700</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">587f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">95d4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">fbe905491fea</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span></code></pre></div></div>
<p>Added in this case:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">sdc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">osd_lvm_uuid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> osd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">block</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">data_vg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ad1a16cd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">b35e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">58d1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">8e40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">80a14597f583</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Commit changes in the configuration repository, sync the configuration repository on
the manager and reconcile the inventory with <code>osism reconciler sync</code>.</p>
</li>
<li class="">
<p>Create new LVM devices.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-create-lvm-devices -l &lt;nodename&gt;</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Everything is now ready for the deployment of the new OSD.
Details on deploying the OSD service in the <a class="" href="/docs/iaas/guides/operations-guide/ceph#add-a-new-osd">Ceph operations guide</a>.</p>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="dashboard">Dashboard<a href="#dashboard" class="hash-link" aria-label="Direct link to Dashboard" title="Direct link to Dashboard" translate="no">​</a></h2>
<p>Password for the admin user of the Ceph dashboard is set via <code>ceph_dashboard_password</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/secrets.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_dashboard_password</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> password</span><br></span></code></pre></div></div>
<p>User name of the admin user, port and listen IP address can be set via additional parameters.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_dashboard_addr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> 0.0.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_dashboard_port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">7000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_dashboard_username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> admin</span><br></span></code></pre></div></div>
<p>The Ceph dashboard is bootstrapped with the <code>ceph-bootstrap-dashboard</code> play.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply ceph-bootstrap-dashboard</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuring-the-openstack-loadbalancer-to-expose-the-ceph-dashboard">Configuring the openstack loadbalancer to expose the ceph dashboard<a href="#configuring-the-openstack-loadbalancer-to-expose-the-ceph-dashboard" class="hash-link" aria-label="Direct link to Configuring the openstack loadbalancer to expose the ceph dashboard" title="Direct link to Configuring the openstack loadbalancer to expose the ceph dashboard" translate="no">​</a></h3>
<p>The ceph dashboard runs in an active/standby configuration. In its default standby instances will
redirect to the active instance. Most deployments will want to use the openstack loadbalancer to
expose the ceph dashboard on the internal network and direct traffic directly to the active
instance.</p>
<p>In this scenario the dashboard should be configured to return an http error with status <code>404</code> on
standby instances.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_dashboard_standby_behaviour</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> error</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_dashboard_standby_error_status_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">404</span><br></span></code></pre></div></div>
<p>Create a loadbalancer configuration</p>
<div class="language-jinja2 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/kolla/files/overlays/haproxy/services.d/ceph_dashboard.cfg</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jinja2 codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{%- set internal_tls_bind_info = &#x27;ssl crt /etc/haproxy/certificates/haproxy-internal.pem&#x27; if kolla_enable_tls_internal|bool else &#x27;&#x27; %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listen ceph_dashboard</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  option httpchk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http-check expect status 200,404</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http-check disable-on-404</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  {{ &quot;bind %s:%s %s&quot;|e|format(kolla_internal_vip_address, 8140, internal_tls_bind_info)|trim() }}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{% for host in groups[&#x27;ceph-mgr&#x27;] %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  server {{ hostvars[host][&#x27;ansible_facts&#x27;][&#x27;hostname&#x27;] }} {{ hostvars[host][&#x27;monitor_address&#x27;] }}:7000 check inter 2000 rise 2 fall 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{% endfor %}</span><br></span></code></pre></div></div>
<p>and apply it.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply -a reconfigure loadbalancer</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="second-ceph-cluster">Second Ceph cluster<a href="#second-ceph-cluster" class="hash-link" aria-label="Direct link to Second Ceph cluster" title="Direct link to Second Ceph cluster" translate="no">​</a></h2>
<p>With OSISM, it is possible to manage any number of independent Ceph clusters via a single OSISM
manager service using sub-environments. A sub environment is basically nothing more than another directory
below the <code>environments</code> directory of the configuration repository with a special name.</p>
<p>A sub-environment for Ceph always has the name <code>ceph.NAME</code>. The <code>ceph.NAME</code> directory in the
configuration repository then contains the <code>configuration.yml</code>, <code>images.yml</code> and <code>secrets.yml</code>
files as usual.</p>
<p>In this example, a sub-environment <code>ceph.rgw</code> is created which is used for a Ceph cluster that
will only be used as an RGW cluster.</p>
<p>In comparison to the normal <code>ceph</code> environment, the groups to be used must be overwritten for a
Ceph sub-environment. In this case, two groups are defined: <code>ceph.rgw</code> and <code>ceph.rgw.empty</code>.
Any other groups can be used, e.g. <code>ceph.rgw.osd</code>. It is recommended to base the name of the
groups on the name of the sub-environments.</p>
<p>The <code>ceph.rgw.empty</code> group is important because there are plays in ceph-ansible that are executed
when nodes are in a specific group. To explicitly avoid this, certain groups are set to the empty
group.</p>
<p>All available group name parameters are listed in the <a href="https://github.com/osism/defaults/blob/main/all/099-ceph.yml" target="_blank" rel="noopener noreferrer" class="">[099-ceph.yml]</a>
file of the <a href="https://github.com/osism/defaults" target="_blank" rel="noopener noreferrer" class="">osism/defaults</a> repository.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">environments/ceph.rgw/configuration.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">##########################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># groups</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">client_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">grafana_server_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">iscsi_gw_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">mds_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">mgr_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">mon_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">nfs_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">osd_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">rbdmirror_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">restapi_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">rgw_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">rgwloadbalancer_group_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ceph.rgw.empty</span><br></span></code></pre></div></div>
<p>The groups used are then added in the inventory in the <code>10-custom</code> file.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">inventory/10-custom</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ceph.rgw]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">testbed-node-3.testbed.osism.xyz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">testbed-node-4.testbed.osism.xyz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">testbed-node-5.testbed.osism.xyz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ceph.rgw.empty]</span><br></span></code></pre></div></div>
<p>The sub environment can then be specified with all <code>apply</code> commands of the OSISM CLI. For example,
to deploy the Ceph mon services of the <code>ceph.rgw</code> sub environment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">osism apply --sub rgw ceph-osds</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="resource-limits">Resource limits<a href="#resource-limits" class="hash-link" aria-label="Direct link to Resource limits" title="Direct link to Resource limits" translate="no">​</a></h2>
<p>Resource limits for the individual Ceph services can be set via <code>environments/ceph/configuration.yml</code>.
The possible parameters and their defaults for memory limits and CPU limits are listed below.</p>
<ul>
<li class="">
<p>Memory limits</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_mds_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ansible_facts[&#x27;memtotal_mb&#x27;] }}m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_mgr_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ansible_facts[&#x27;memtotal_mb&#x27;] }}m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_mon_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ansible_facts[&#x27;memtotal_mb&#x27;] }}m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_osd_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ansible_facts[&#x27;memtotal_mb&#x27;] }}m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rbd_mirror_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{{ ansible_facts[&#x27;memtotal_mb&#x27;] }}m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rgw_docker_memory_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;4096m&quot;</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>CPU limits</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ceph_mds_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_mgr_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_mon_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_osd_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rbd_mirror_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">ceph_rgw_docker_cpu_limit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cpu-pinning">CPU Pinning<a href="#cpu-pinning" class="hash-link" aria-label="Direct link to CPU Pinning" title="Direct link to CPU Pinning" translate="no">​</a></h2>
<p>CPU pinning and specifying the NUMA nodes to be used for the Ceph OSD and RGW services can be
set via <code>environments/ceph/configuration.yml</code>.
The possible parameters and possible values are listed below. The parameters are not enabled
by default.</p>
<ul>
<li class="">
<p>Limit the specific CPUs or cores a container can use. A comma-separated list or
hyphen-separated range of CPUs a container can use, if you have more than one CPU.
The first CPU is numbered 0. A valid value might be 0-3 (to use the first, second,
third, and fourth CPU) or 1,3 (to use the second and fourth CPU).</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ceph_osd_docker_cpuset_cpus: &quot;0,2,4,6,8,10,12,14,16&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ceph_rgw_docker_cpuset_cpus: &quot;0,2,4,6,8,10,12,14,16&quot;</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Memory nodes in which to allow execution (e.g. 0-3, 0,1). Only effective on NUMA systems.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ceph_osd_docker_cpuset_mems: &quot;0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ceph_rgw_docker_cpuset_mems: &quot;0&quot;</span><br></span></code></pre></div></div>
<p>Available NUMA nodes on a node can be displayed with <a href="https://github.com/numactl/numactl" target="_blank" rel="noopener noreferrer" class="">numactl</a>.
In this example, there are 2 NUMA nodes. The pinned CPUs should all be assigned to the
specified NUMA node.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># numactl --hardware</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">available: 2 nodes (0-1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 0 cpus: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 0 size: 515581 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 0 free: 511680 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 1 cpus: 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 1 size: 516078 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node 1 free: 511865 MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node distances:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node   0   1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  0:  10  20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  1:  20  10</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="use-of-rbds-for-nodes">Use of RBDs for nodes<a href="#use-of-rbds-for-nodes" class="hash-link" aria-label="Direct link to Use of RBDs for nodes" title="Direct link to Use of RBDs for nodes" translate="no">​</a></h2>
<ol>
<li class="">
<p>Add an extra pool (see <a href="#extra-pools" class="">Extra pools</a>).</p>
</li>
<li class="">
<p>Add a key for the new pool (see <a href="#extra-keys" class="">Extra keys</a>).</p>
</li>
<li class="">
<p>Add nodes on which RBDs are to be used to the inventory group <code>cephclient</code>. The file
<code>99-overwrite</code> must be used for this. By default, the inventory group looks like this:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[cephclient:children]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">manager</span><br></span></code></pre></div></div>
<p>It could look like this with the additional inventory group:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[cephclient:children]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">manager</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">testbed-resource-nodes</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Prepare the configuration of the Ceph client. Get the keyring with
<code>ceph auth get client.extra001</code>.</p>
</li>
</ol>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">cephclient_install_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> package</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">cephclient_keyring_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> client.extra001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">cephclient_keyring</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">  [client.extra001]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      key = AQBiHV9nAAAAABAAhtxl8rdW/EBvxiOGw4iMJw==</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      caps mon = &quot;profile rbd&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      caps osd = &quot;profile rbd pool=extra001&quot;</span><br></span></code></pre></div></div>
<p>For Ubuntu 24.04 nodes also add the following parameter. At the moment no Ceph packages
are available for Ubuntu 24.04.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">cephclient_debian_repository</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;deb https://download.ceph.com/debian-{{ cephclient_version }} jammy main&quot;</span><br></span></code></pre></div></div>
<ol start="5">
<li class="">
<p>Create new RBD in the new pool (run this command on the manager node).
In this example, the name of the node on which the RBD is to be used is
used as the name for the RBD.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rbd create testbed-node-5 --size 64 --pool extra001</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>On the node map the RBD as block device.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo rbd map testbed-node-5 --pool extra001 --id extra001</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>On the node check the mapped block device.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo rbd showmapped --id extra001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">id  pool      namespace  image           snap  device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0   extra001             testbed-node-5  -     /dev/rbd0</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Done. <code>/dev/rbd0</code> can now be used like a normal block device.</p>
</li>
<li class="">
<p>The file <code>/etc/ceph/rbdmap</code> is used to persist the mapping. The service <code>rbdmap.service</code>
must be activated and started for this.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">extra001/testbed-node-5 id=extra001,keyring=/etc/ceph/ceph.client.extra001.keyring</span><br></span></code></pre></div></div>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/SovereignCloudStack/docs/tree/main/docs/02-iaas/guides/configuration-guide/ceph/index.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/iaas/guides/configuration-guide/loadbalancer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Loadbalancer</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/iaas/guides/configuration-guide/ceph/rook"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration for Rook</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#unique-identifier" class="table-of-contents__link toc-highlight">Unique Identifier</a></li><li><a href="#client" class="table-of-contents__link toc-highlight">Client</a></li><li><a href="#swappiness" class="table-of-contents__link toc-highlight">Swappiness</a></li><li><a href="#rgw-service" class="table-of-contents__link toc-highlight">RGW service</a></li><li><a href="#pools-and-keys" class="table-of-contents__link toc-highlight">Pools and Keys</a><ul><li><a href="#extra-pools" class="table-of-contents__link toc-highlight">Extra pools</a></li><li><a href="#extra-keys" class="table-of-contents__link toc-highlight">Extra keys</a></li></ul></li><li><a href="#osd-devices" class="table-of-contents__link toc-highlight">OSD devices</a><ul><li><a href="#full-examples" class="table-of-contents__link toc-highlight">Full examples</a></li><li><a href="#add-a-new-osd" class="table-of-contents__link toc-highlight">Add a new osd</a></li></ul></li><li><a href="#dashboard" class="table-of-contents__link toc-highlight">Dashboard</a><ul><li><a href="#configuring-the-openstack-loadbalancer-to-expose-the-ceph-dashboard" class="table-of-contents__link toc-highlight">Configuring the openstack loadbalancer to expose the ceph dashboard</a></li></ul></li><li><a href="#second-ceph-cluster" class="table-of-contents__link toc-highlight">Second Ceph cluster</a></li><li><a href="#resource-limits" class="table-of-contents__link toc-highlight">Resource limits</a></li><li><a href="#cpu-pinning" class="table-of-contents__link toc-highlight">CPU Pinning</a></li><li><a href="#use-of-rbds-for-nodes" class="table-of-contents__link toc-highlight">Use of RBDs for nodes</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Contribute</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@sovereigncloudstack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</div></div></div></footer></div>
</body>
</html>