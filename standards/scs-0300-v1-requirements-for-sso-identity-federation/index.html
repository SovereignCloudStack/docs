<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-standards docs-version-current docs-doc-page docs-doc-id-scs-0300-v1-requirements-for-sso-identity-federation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Requirements for SSO identity federation | One platform — standardized, built and operated by many.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" name="twitter:image" content="https://docs.scs.community/img/scs-og-basic.png"><meta data-rh="true" property="og:url" content="https://docs.scs.community/standards/scs-0300-v1-requirements-for-sso-identity-federation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-standards-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-standards-current"><meta data-rh="true" property="og:title" content="Requirements for SSO identity federation | One platform — standardized, built and operated by many."><meta data-rh="true" name="description" content="The SCS-0300 standard outlines requirements for Single Sign-On (SSO) identity federation within the Sovereign
Cloud Stack (SCS). It addresses the need for customers to access SCS services using credentials stored and managed
externally, facilitating user onboarding and reducing the need for additional dedicated SCS accounts. The standard
focuses on delegating authentication to external identity providers and mapping users to roles within SCS for
authorization, while also considering the use of machine identities. Keycloak is the current choice as an Identity
Provider (IdP) for its support of OAuth 2.0 grants and its integration with OpenStack and kolla-ansible.
"><meta data-rh="true" property="og:description" content="The SCS-0300 standard outlines requirements for Single Sign-On (SSO) identity federation within the Sovereign
Cloud Stack (SCS). It addresses the need for customers to access SCS services using credentials stored and managed
externally, facilitating user onboarding and reducing the need for additional dedicated SCS accounts. The standard
focuses on delegating authentication to external identity providers and mapping users to roles within SCS for
authorization, while also considering the use of machine identities. Keycloak is the current choice as an Identity
Provider (IdP) for its support of OAuth 2.0 grants and its integration with OpenStack and kolla-ansible.
"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scs.community/standards/scs-0300-v1-requirements-for-sso-identity-federation"><link data-rh="true" rel="alternate" href="https://docs.scs.community/standards/scs-0300-v1-requirements-for-sso-identity-federation" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scs.community/standards/scs-0300-v1-requirements-for-sso-identity-federation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="One platform — standardized, built and operated by many. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="One platform — standardized, built and operated by many. Atom Feed">








<link rel="preconnect" href="https://matomo.scs.community/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://matomo.scs.community/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","2"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/assets/css/styles.0eddb8c7.css">
<script src="/assets/js/runtime~main.ede2d0ee.js" defer="defer"></script>
<script src="/assets/js/main.ff9c6252.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="SCS" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/standards">Standards</a><a class="navbar__item navbar__link" href="/docs">For Operators</a><a class="navbar__item navbar__link" href="/contributor-docs">For Contributors</a><a class="navbar__item navbar__link" href="/user-docs">For Users</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/standards/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/standards/certification/digisov-and-cert">Certification</a><button aria-label="Expand sidebar category &#x27;Certification&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/standards/standards/overview">Standards</a><button aria-label="Collapse sidebar category &#x27;Standards&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/global/">Global</a><button aria-label="Expand sidebar category &#x27;Global&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/iaas/">IaaS</a><button aria-label="Expand sidebar category &#x27;IaaS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/kaas/">KaaS</a><button aria-label="Expand sidebar category &#x27;KaaS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/standards/iam/">IAM</a><button aria-label="Collapse sidebar category &#x27;IAM&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/standards/iam/scs-0300">scs-0300</a><button aria-label="Collapse sidebar category &#x27;scs-0300&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/standards/scs-0300-v1-requirements-for-sso-identity-federation">V1</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/iam/scs-0301">scs-0301</a><button aria-label="Expand sidebar category &#x27;scs-0301&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/iam/scs-0302">scs-0302</a><button aria-label="Expand sidebar category &#x27;scs-0302&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/standards/ops/">Ops</a><button aria-label="Expand sidebar category &#x27;Ops&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/standards/standards/overview"><span itemprop="name">Standards</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/standards/iam/"><span itemprop="name">IAM</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/standards/iam/scs-0300"><span itemprop="name">scs-0300</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">V1</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Requirements for SSO identity federation</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Our assumption is that there are use cases, where CSPs would like to be able to
let customers access their SCS based services by identifying themselves with
credentials that are stored and managed external to the CSP&#x27;s SCS installation.</p>
<p>This is based on the observation that prospective customers of an SCS based CSP
sometimes already come equipped with an IAM solution of their choice, either on
premises or e.g. as an external 3rd party cloud service. To ease onboarding of
customer employees (or e.g. customer contracted 3rd party admin staff) as SCS
users, it would be good to be able to consume these external identities in SCS.</p>
<p>For customers this avoids the necessity to explicitly maintain an additional
dedicated account in SCS and this also reduces what SCS needs to do with
respect to taking care of persisting user account information.</p>
<p>To put it in other words, in SCS we would like to be able to delegate
authentication to external identity providers and map those users to roles in
SCS that can be used for authorization decisions when users access SCS services.</p>
<p>In addition to user identities there we also see the necessity to support the
use of &quot;machine identities&quot; (aka &quot;workload identities&quot; or &quot;service accounts&quot;).
These will probably be SCS-local accounts and have for example the purpose
to grant CaaS workload access to storage resources served by the infrastructure
layer. Exact architectural details for this are still in active discussion,
but it is anticipated that the IdP component should be very useful in
facilitating the integration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="motivation-for-this-document">Motivation for this document<a href="#motivation-for-this-document" class="hash-link" aria-label="Direct link to Motivation for this document" title="Direct link to Motivation for this document">​</a></h2>
<p>SCS has multiple service layers, like IaaS and CaaS, both of which running their
own technological stack with specific internal models of accounts and
authorization.</p>
<p>One thing these services have in common, is that they are able
to use SSO protocols like OAuth 2.0 or OpenID Connect (OIDC) on top of it to
delegate authentication. They are service providers (SAML terminology) and can
be relying on parties (OIDC terminology) of a protocol compliant identity provider
(IdP).</p>
<p>So the idea is, to run an SSO IdP as part of SCS to provide a dedicated point
of entry for identities, which the SCS service layers can use as a common
interface to consume external user identities.</p>
<p>The purpose of this document is to specify what requirements a specific
technical IdP implementation (i.e. software solution) needs to fulfill
in the context of SCS.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-considerations">Design Considerations<a href="#design-considerations" class="hash-link" aria-label="Direct link to Design Considerations" title="Direct link to Design Considerations">​</a></h2>
<p>As a central service for identity handling, the IdP
service needs to be robust and reliable.</p>
<p>Customers shall be able to access self-service, so that
they can make reasonable adjustments e.g. to role mapping.
At the time of writing this document it&#x27;s still undecided
if SCS has the requirement of a dedicated &quot;self-service&quot; service
that serves as a frontend to provision and re-configure
customer specific data, abstracting e.g. from IdP specific
user interface particularities.</p>
<p>Keycloak is currently being deployed as part of the IaaS reference implementation.
Technically this IdP component shall be shifted from the management
plane to be run on the basis of a &quot;minimal&quot; Kubernetes (e.g. K3S),
e.g. to make use of the &quot;self-healing&quot; and scaling features achievable
with that.</p>
<p>So one of the considerations is if the solution will work well on a
K8S environment. The instances will need to share configuration
(probably via the shared backend database) as well as session state.
Maybe one is better prepared for horizontal scaling than the other.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="options-considered">Options considered<a href="#options-considered" class="hash-link" aria-label="Direct link to Options considered" title="Direct link to Options considered">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="keycloak">Keycloak<a href="#keycloak" class="hash-link" aria-label="Direct link to Keycloak" title="Direct link to Keycloak">​</a></h4>
<p>Keycloak is a commonly used IdP solution implemented in Java.
It is developed as an open source community project.
Red Hat uses it as upstream source for their Red Hat SSO product
and is also listed as sponsor of the project.
Starting with version 17 the default distribution is based on
Quarkus instead of WildFly/JBoss.</p>
<p>The project maintains several means of community contributions
as listed on the <a href="https://www.keycloak.org/community" target="_blank" rel="noopener noreferrer">community section</a>
of the project website. It uses <a href="https://github.com/keycloak/keycloak/issues" target="_blank" rel="noopener noreferrer">GitHub issues</a>
to track development.</p>
<p>It offers a REST API for administration and there&#x27;s a separately maintained
3rd party python module as well as ansible support for it. Both of these are
downstream of Keycloak itself and may thus not always be feature complete and
suffer latency with respect to getting adjusted to upstream changes.</p>
<p>It offers support for commonly used SSO protocols and is &quot;reasonably&quot; fast
in adopting to protocol standard changes and extensions. This has been
observed in the case of logout support (backend and frontend variants) in OIDC.</p>
<p>It offers a concept of &quot;Identity Brokering&quot;, where Keycloak is not just IdP
but also &quot;client&quot; to other IdPs. This allows daisy-chaining of identity
federation. In this configuration it can work as a point of protocol
transition between different supported SSO protocols (SAML, OAuth 2.0, etc.).</p>
<p>Beyond this capability of using other IdPs as identity sources, it also supports
using classic LDAP based IAM services as backend (OpenLDAP and Active Directory,
e.g.).</p>
<p>Keycloak&#x27;s implementation makes some design decisions, that are specific
to it and have consequences for clients of the service. E.g. Keycloak
has a concept of management &quot;Realms&quot;, which have their own specific
set of HTTP API entrypoints, both for administration and for IdP
requests.</p>
<p>Commonly Keycloak realms can be used to map them 1:1 to user domains,
but since Keycloak supports configuring multiple backend IdPs in a
realm to be used for &quot;Identity Brokering&quot;, there is always the
possibility to create a kind of &quot;proxy&quot; realm to provide a single
standard set of HTTP API endpoints for SSO clients (service providers)
to avoid the need to frequently extend/reduce client service configuration
whenever a new IdP federation needs to be added to Keycloak to onboard
a new customer. This is relevant for services like OpenStack Keystone,
which currently cannot be easily reconfigured for new SSO endpoints
without restarting the service, making the service unavailable for
a short span of time and increasing risk connected with service restarts.</p>
<p>Since version 17, Keycloak claims that it&#x27;s capability for
&quot;cloud native&quot; deployments on Kubernetes has improved.</p>
<p>Keycloak is offering a <a href="https://www.keycloak.org/documentation" target="_blank" rel="noopener noreferrer">documented REST API</a>
for all aspects of its administration interface.</p>
<p>For storage of Keycloak configuration and local user metadata
(e.g. from which external IdP a user account originally came from)
Keycloak supports several SQL backends through JDBC. Thus,
it can be hooked up to a Postgres Database or to a
MariaDB/Galera cluster e.g.</p>
<p>As of April 11, 2023, Keycloak joined the CNCF as an incubating project.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="zitadel">Zitadel<a href="#zitadel" class="hash-link" aria-label="Direct link to Zitadel" title="Direct link to Zitadel">​</a></h4>
<p>Zitadel is a newer implementation of an SSO IdP.
It is implemented in Go and under active development and maintained by ZITADEL.</p>
<p>The project is open for community <a href="https://github.com/zitadel/zitadel/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">contributions</a>
to all parts of the ecosystem.
Feature requests and bugs being tracked on <a href="https://github.com/orgs/zitadel/projects/2/views/5" target="_blank" rel="noopener noreferrer">GitHub</a> for development.
Community questions can be asked in the <a href="https://zitadel.com/chat" target="_blank" rel="noopener noreferrer">public chat</a> or via <a href="https://github.com/zitadel/zitadel/discussions" target="_blank" rel="noopener noreferrer">GitHub Discussions</a>.
ZITADEL offers support for the commonly used authentication and authorization protocols such as OIDC, OAuth2, SAML2.
It is a compliant and certified OpenID Connect provider with support for various Grant Types for both human users and machine users.
Compared to Keycloak SPIs, ZITADEL offers Actions to customize and integrate (eg, calling external APIs, Webhooks, customizing pre-built workflows, customizing tokens)
Actions are executed at runtime and can be maintained independently of platform.
Identity brokering (OIDC, SAML, JWT) can be configured system-wide or for each organization with templates.
Users will be created just in time for audit purposes and linked to the external identity provider.
Users can have multiple identity providers linked to their profile.</p>
<p>It came to attention of the SCS project because it offers a
fresh take of an organization focussed data model, which has
the potential to simplify IdP federation to SCS customer domains
in the following areas:</p>
<ul>
<li>For client services (single set of HTTP API endpoints).</li>
<li>For SCS operators for provisioning customer <a href="https://zitadel.com/docs/concepts/structure/organizations" target="_blank" rel="noopener noreferrer">organizations</a>
and robust configuration by using templated client, role and mapping
configuration.</li>
<li>For SCS customers for a robust user experience for self servicing.</li>
</ul>
<p>The concept for <a href="https://zitadel.com/docs/concepts/structure/organizations" target="_blank" rel="noopener noreferrer">Delegated Access Management</a>
reduces the management overhead compared to isolated realms.
Projects (Applications + Roles) can be maintained by one organization and delegated to be used by other Organizations.
Managers that receive granted Projects can assign users permissions to use the project.</p>
<p><a href="https://zitadel.com/docs/apis/introduction" target="_blank" rel="noopener noreferrer">Zitadel is offering REST APIs</a>
for multiple areas of use and configuration.</p>
<p>It recently also added support for the <a href="https://github.com/zitadel/oidc/issues/141" target="_blank" rel="noopener noreferrer">Device Authorization Grant</a>,
which, at time of writing, is a feature that is relevant
for SCS to be able to use OpenStack CLI and APIs with federated
identities (<a href="https://github.com/SovereignCloudStack/issues/issues/221" target="_blank" rel="noopener noreferrer">Device Authorization Grant</a>).</p>
<p>Support for consumption of LDAP backends is available since <a href="https://github.com/zitadel/zitadel/releases/tag/v2.23.0" target="_blank" rel="noopener noreferrer">Zitadel v2.23.0</a>
(see <a href="https://zitadel.com/docs/guides/integrate/identity-providers/ldap" target="_blank" rel="noopener noreferrer">this guide</a>).</p>
<p>ZITADEL supported backend databases are CockroachDB and PostgreSQL.</p>
<p>For <a href="https://zitadel.com/docs/self-hosting/manage/production" target="_blank" rel="noopener noreferrer">production setups</a> it is recommended
to use Kubernetes (or similar like Knative) and CockroachDB.</p>
<p>At time of writing a PoC &quot;spike&quot; is done to assess and verify the hopes
connected with Zitadel in the context of the SCS testbed.</p>
<p>Currently, Zitadel is lacking the possibility to easily add custom claims.
It supports <code>urn:zitadel:iam:user:metadata</code>, but that is more suitable
towards Kubernetes and cannot be parsed with the OpenStack mapping mechanism.
<a href="https://github.com/zitadel/zitadel/issues/3997" target="_blank" rel="noopener noreferrer">There is work going on</a> which
may be suitable to resolve this issue.
An approach based on Zitadel actions is also currently evaluated.
OpenStack currently makes use of custom claims to pass <code>openstack-default-project</code>
from the IdP to OpenStack. Combined with federation to external customer managed IdPs
this should allow customers to manage settings like these in their own IAM.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="open-questions">Open questions<a href="#open-questions" class="hash-link" aria-label="Direct link to Open questions" title="Direct link to Open questions">​</a></h2>
<ul>
<li>How would we implement testbed deployment support for Zitadel?<!-- -->
<ul>
<li>e.g. <code>wsgi-keystone.conf</code> would need to look different. One template covering both options?</li>
<li>e.g. steps like <code>openstack federation protocol create</code> would probably be different.</li>
</ul>
</li>
<li>Should we support both as options?<!-- -->
<ul>
<li>What&#x27;s the benefit?</li>
<li>How would we allow SCS operators to choose?</li>
</ul>
</li>
<li>Do we need some kind of SWOT analysis to come to a decision?</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="decision">Decision<a href="#decision" class="hash-link" aria-label="Direct link to Decision" title="Direct link to Decision">​</a></h2>
<p>SCS wants to make use of an IdP as part of the reference implementation.
To move forward with topics of configuration and mapping of roles in a
OAuth2 federation scenario as well as questions of token lifecycles etc. across
the federation stack it makes sense to focus on one IdP implementation at a
given time. Both considered options seem to be potentially viable, but ultimately,
a decision should be made, even if there are no strict/strong reasons for
dismissing either option in particular.</p>
<p>The project&#x27;s current choice is Keycloak for the following reasons:
Keycloak currently supports the OAuth 2.0 grants that SCS wants to make
use of (e.g. Device Authorization Grant). It is the implementation for
which integration is currently documented in OpenStack and implemented
in kolla-ansible. SCS currently deploys Keycloak and the IAM team has
most hands-on experience with it, e.g. when it comes to collateral questions
like how to make TLS and signing certificates available to the IdP that shall
be used in federation to external domains.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-documents">Related Documents<a href="#related-documents" class="hash-link" aria-label="Direct link to Related Documents" title="Direct link to Related Documents">​</a></h2>
<ul>
<li><a href="https://github.com/SovereignCloudStack/standards/tree/main/Drafts/IAM-federation" target="_blank" rel="noopener noreferrer">https://github.com/SovereignCloudStack/standards/tree/main/Drafts/IAM-federation</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conformance-tests">Conformance Tests<a href="#conformance-tests" class="hash-link" aria-label="Direct link to Conformance Tests" title="Direct link to Conformance Tests">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conformance-tests-optional">Conformance Tests, OPTIONAL<a href="#conformance-tests-optional" class="hash-link" aria-label="Direct link to Conformance Tests, OPTIONAL" title="Direct link to Conformance Tests, OPTIONAL">​</a></h2></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/standards/iam/scs-0300"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">scs-0300: Requirements for SSO identity federation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/standards/iam/scs-0301"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">scs-0301: Naming for domains/groups/roles/project when onboarding new customers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#motivation-for-this-document" class="table-of-contents__link toc-highlight">Motivation for this document</a></li><li><a href="#design-considerations" class="table-of-contents__link toc-highlight">Design Considerations</a><ul><li><a href="#options-considered" class="table-of-contents__link toc-highlight">Options considered</a></li></ul></li><li><a href="#open-questions" class="table-of-contents__link toc-highlight">Open questions</a></li><li><a href="#decision" class="table-of-contents__link toc-highlight">Decision</a></li><li><a href="#related-documents" class="table-of-contents__link toc-highlight">Related Documents</a></li><li><a href="#conformance-tests" class="table-of-contents__link toc-highlight">Conformance Tests</a></li><li><a href="#conformance-tests-optional" class="table-of-contents__link toc-highlight">Conformance Tests, OPTIONAL</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@sovereigncloudstack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/SovereignCloudStack/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</div></div></div></footer></div>
</body>
</html>